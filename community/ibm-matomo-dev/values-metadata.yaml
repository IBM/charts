arch:
  __metadata:
    label: "Architecture scheduling preferences"
    description: "Architecture preference for target worker node."
  amd64:
    __metadata:
      name: "amd64"
      label: "AMD64 scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"
  ppc64le:
    __metadata:
      name: "ppc64le"
      label: "PPC64LE scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"
  s390x:
    __metadata:
      name: "s390x"
      label: "S390X scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"

image:
  __metadata:
    label: "Image"
    description: "Docker image details"
  registry:
    __metadata:
      label: "Image registry"
      description: "Docker image registry"
  repository:
    __metadata:
      name: "repository"
      label: "Repository"
      description: "Docker image location"
      type: "string"
      required: true
  tag:
    __metadata:
      name: "tag"
      label: "Tag"
      description: "Docker image tag"
      type: "string"
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Docker image pull policy"
      description: "Defaults to 'Always' when the latest tag is specified. Otherwise the default is 'IfNotPresent'."
      type: "string"
      required: true
      options:
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
      - label: "IfNotPresent"
        value: "IfNotPresent"

matomoTablePrefix:
  __metadata:
    name: "matomoTablePrefix"
    label: "Matomo Table Prefix"
    description: "DB table prefix for Matomo application"
    type: "string"

replicaCount:
  __metadata:
    name: "replicaCount"
    label: "Replicas"
    description: "Number of replicas of deployment needed to be created"
    type: "number"
    required: true

## External Database configuration
externalDatabase:
  __metadata:
    label: "External Database"
    description: "External database configurations. All of these values are only used when mariadb is not enabled."
  host:
    __metadata:
      label: "Database host"
      description: "Database Hostname"
  user:
    __metadata:
      label: "Database user"
      description: "non-root Username for Matomo Database"
  password:
    __metadata:
      label: "Database password"
      description: "non-root password for Matomo Database"
  database:
    __metadata:
      label: "Database name"
      description: "Matomo Database"
  port:
    __metadata:
      label: "Database port number"
      description: "Port on which the matomo database is exposed"

## MariaDB chart configuration
mariadb:
  __metadata:
    label: "Database configuration"
    description: "Whether to deploy a mariadb server to satisfy the applications database requirements."
  enabled:
    __metadata:
      label: "Enable mariadb"
      description: "Specifies whether to enable mariadb"
      type: "boolean"

  database:
    user:
      __metadata:
        label: "User name"
        description: "New user to create"
        type: "string"
    password:
      __metadata:
        label: "Password"
        description: "Password of the new user to create"
        type: "string"
    name:
      __metadata:
        label: "Database name"
        description: "Name of the Matomo database"
        type: "string"

  service:
    port:
      __metadata:
        label: "Mariadb HTTP Port"
        description: "The HTTP port that the DB container will expose"
        type: "number"
        required: true

  persistence:
    enabled:
      __metadata:
        label: "Enable persistence storage for mariadb deployment"
        description: "Enables persistence storage for mariadb deployment. A persistence volume is required."
        type: "boolean"
    useDynamicProvisioning:
      __metadata:
        label: "Use dynamic provisioning for persistent volume"
        description: "This option will automatically provision the requested volume if set to true. Defaults to false."
        type: "boolean"

  dataVolume:
    name:
      __metadata:
        label: "Name of the persistent volume claim"
        description: "By default a persistent volume claim will be created with this name."
        type: "string"
    existingClaimName:
      __metadata:
        label: "Existing volume claim"
        description: "By default a new persistent volume claim will be created. Specify an existing claim here if one is available."
        type: "string"
    storageClassName:
      __metadata:
        label: "Existing storage class name"
        description: "Choose a specific storage class name. Defaults to the default storage class in the cluster."
        type: "string"
    accessModes:
      __metadata:
        label: "PVC access mode"
        description: "ReadWriteOnce, ReadOnlyMany, or ReadWriteMany."
        type: "string"
        options:
        - label: "ReadWriteOnce"
          value: "ReadWriteOnce"
        - label: "ReadOnlyMany"
          value: "ReadOnlyMany"
        - label: "ReadWriteMany"
          value: "ReadWriteMany"
    size:
      __metadata:
        label: "Size of the volume claim"
        description: "Defaults to 8Gi of storage request. Choose a different size of disk if needed."
        type: "string"

livenessProbe:
  __metadata:
    label: "Liveness Probe"
    description: "Liveness Probe configuration"
  initialDelaySeconds:
    __metadata:
      label: "Liveness probe initial delay seconds"
      description: "Number of seconds after the container has started before the probe is initiated."
      type: "number"
  periodSeconds:
    __metadata:
      label: "Liveness probe period seconds"
      description: "How often (in seconds) to perform the probe."
      type: "number"
  timeoutSeconds:
    __metadata:
      label: "Liveness probe timeout seconds"
      description: "Number of seconds after which the probe times out."
      type: "number"
  successThreshold:
    __metadata:
      label: "Liveness probe success threshold"
      description: "Minimum consecutive successes for the probe to be considered successful after having failed."
      type: "number"
  failureThreshold:
    __metadata:
      label: "Liveness probe failure threshold"
      description: "Number of failures to accept before giving up and marking the pod as Unready."
      type: "number"

readinessProbe:
  __metadata:
    label: "Readiness Probe"
    description: "Readiness Probe configuration"
  initialDelaySeconds:
   __metadata:
     label: "Readiness probe initial delay seconds"
     description: "Number of seconds after the container has started before the probe is initiated."
     type: "number"
  periodSeconds:
   __metadata:
     label: "Readiness probe period seconds"
     description: "How often (in seconds) to perform the probe."
     type: "number"
  timeoutSeconds:
    __metadata:
      label: "Readiness probe timeout seconds"
      description: "Number of seconds after which the probe times out."
      type: "number"
  successThreshold:
    __metadata:
      label: "Readiness probe success threshold"
      description: "Minimum consecutive successes for the probe to be considered successful after having failed."
      type: "number"
  failureThreshold:
    __metadata:
      label: "Readiness probe failure threshold"
      description: "Number of failures to accept before giving up and restarting the."
      type: "number"

service:
  __metadata:
    label: "Service"
    description: "Application Service Details"
  type:
    __metadata:
      label: "Service Type"
      description: "Type of Service- NodePort, ClusterIP, LoadBalancer"
      type: "string"
      options:
      - label: "ClusterIP"
        value: "ClusterIP"
      - label: "NodePort"
        value: "NodePort"
      - label: "LoadBalancer"
        value: "LoadBalancer"
      - label: "IfNotPresent"
        value: "IfNotPresent"
  port:
    __metadata:
      label: "HTTP Port"
      description: "The HTTP port that the container will expose internally in the cluster."
      type: "number"
      required: true

  nodePorts:
    http:
      __metadata:
        label: "HTTP Port"
        description: "The HTTP port (30000 - 32767) that the container will expose outside the cluster. By default a random port will be assigned."
        type: "string"

  annotations:
    __metadata:
      label: "Service Annotations"
      description: "Custom service annotations."
      type: "string"

ingress:
  __metadata:
    label: "Ingress settings"
    description: "Ingress Details"
  enabled:
    __metadata:
      name: "enabled"
      label: "Enable Ingress"
      description: "Specifies whether to use Ingress."
      type: "boolean"
  annotations:
    __metadata:
      label: "Vault Ingress Annotation"
      description: "Specify the annotations for Matomo ingress."
      type: "string"
  path:
    __metadata:
      name: "path"
      label: "Path"
      description: "Path must match the content of an incoming request before the loadbalancer directs traffic to the backend."
      type: "string"
  hosts:
    __metadata:
      label: "Virtual hosts"
      description: "Name-based virtual hosts"
      type: "string"
  tls:
    __metadata:
      name: "tls"
      label: "TLS"
      description: "TLS consisting of secret name and hosts"
      type: "string"

persistence:
  __metadata:
    label: "Application Persistence"
    description: "Application Persistence configuration"
  enabled:
    __metadata:
      label: "Enable persistence storage for this deployment"
      description: "Enables persistence storage for this deployment. Defaults to false. A persistent volume is required."
      type: "boolean"
  useDynamicProvisioning:
    __metadata:
      label: "Use dynamic provisioning for persistent volume"
      description: "If true, storage will be automatically provisioned. If false, you can create your persistent volumes manually."
      type: "boolean"
  accessMode:
    __metadata:
      label: "PVC access mode"
      description: "ReadWriteOnce, ReadOnlyMany, or ReadWriteMany."
      type: "string"
      options:
      - label: "ReadWriteOnce"
        value: "ReadWriteOnce"
      - label: "ReadOnlyMany"
        value: "ReadOnlyMany"
      - label: "ReadWriteMany"
        value: "ReadWriteMany"
  existingClaim:
    __metadata:
      label: "Existing volume claim"
      description: "By default a new persistent volume claim will be created. Specify an existing claim here if one is available."
      type: "string"
  storageClass:
    __metadata:
      label: "Storage class name"
      description: "Choose a specific storage class name. Default to the default storage class in the cluster."
      type: "string"
  size:
    __metadata:
      label: "Size of the volume claim"
      description: "Default to 8Gi of storage request. Choose a different size of disk if needed."
      type: "string"

resources:
    __metadata:
      label: "Resources"
      description: "Resource requests and limits configuration"

nodeSelector:
  __metadata:
    label: "Node Selector"
    description: "Specify the extra node selector for deployment."
    type: "string"
    minProperties: 0

tolerations:
  __metadata:
    name: "tolerations"
    label: "Tolerations"
    description: "Toleration labels for pod assignment, e.g. [{\"key\": \"key\", \"operator\":\"Equal\", \"value\": \"value\", \"effect\":\"NoSchedule\"}]"
    type: "string"

affinity:
  __metadata:
    label: "Affinity"
    description: "Affinity for pod assignment"

podAnnotations:
  __metadata:
    label: "Pod Annotations"
    description: "Pod Annotations"
    type: "string"
