# DO NOT modify this conditional check
{{- if eq (.Values.externalDB.enableExternalDB|quote|lower) "\"true\"" }}
apiVersion: v1
kind: Service
metadata:
  name: mariadb
  namespace: {{ .Release.Namespace }}
  labels:
    name: mariadb
{{ include "cam.labels" .  | indent 4 }}
spec:
  type: ExternalName
  externalName: {{ .Values.externalDbService }}.{{ .Values.externalDbNamespace }}.svc.cluster.local
  ports:
    - port: 3168
{{ else }}
apiVersion: v1
kind: Service
metadata:
  name: mariadb
  labels:
    name: mariadb
{{ include "cam.labels" .  | indent 4 }}
spec:
  # DO NOT modify this conditional check
  {{ if eq (.Values.mysqlReplication|quote|lower) "\"true\"" }}
  type: {{ .Values.serviceType }}
  {{ else }}
  type: ClusterIP
  {{ end }}
  ports:
    - port: 3168
      targetPort: 3168
      # DO NOT modify this conditional check
      {{ if eq (.Values.mysqlReplication|quote|lower) "\"true\"" }}
      nodePort: {{ .Values.mysqlNodeport }}
      {{ end }}
      protocol: TCP
      name: mysql
  selector:
    name: mariadb-deploy
{{ end }}
