## Metadata for IBM Netcool/OMNIBus SNMP Probe configuration
## This metadata is used to augment the value.yaml to drive IPC UI for configuration of the Helm chart installation
    
## License acceptance
license:
  __metadata:
    name: "license"
    label: "Docker image license acceptance"
    description: "Must be set to \"accept\" to proceed with installation. Defaults to Not Accepted. Use the tick the checkbox above to set the value to \"accept\""
    type: "string"
    immutable: false
    required: true
    hidden: false
    options:
    - label: "Not Accepted"
      value: "not accepted"
    - label: "Accept"
      value: "accept"

arch:
 __metadata:
   name: "Architecture"
   label: "Worker node architecture"
   description: "Worker node architecture to deploy to. Supports AMD64 architecture only."
   type: "string"
   immutable: true
   required: true
   options:
     - label: "AMD64"
       value: "amd64"

## Replica count configuration metadata
replicaCount: 
  __metadata:
    name: "replicaCount"
    label: "Replica Count"
    description: "Deployment replicaCount - optional field dependent on workload"
    type: "number"
    immutable: false
    required: false


## Image configuration metadata
image:
  __metadata:
    label: "Docker image"
    name: "image"
    description: "Docker Image Configuration"
  repository:
    __metadata:
      name: "repository"
      label: "Docker Image Repository"
      description: "Docker image repository. The image name should be set to \"netcool-probe-snmp\"."
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      name: "tag"
      label: "Docker image Tag"
      description: "Specific image tag to use."
      type: "string"
      immutable: false
      required: true
  testRepository:
    __metadata:
      name: "testRepository"
      label: "Test Image Repository"
      description: "Docker image repository for the test image."
      type: "string"
      immutable: false
      required: true
  testImageTag:
    __metadata:
      name: "testImageTag"
      label: "Docker test image tag"
      description: "Specific image tag to use for the test image"
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Docker Image Pull Policy"
      description: "Always, Never, or IfNotPresent. Defaults to IfNotPresent."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
      - label: "IfNotPresent"
        value: "IfNotPresent"


global:
  __metadata:
    label: "Global"
    description: "Global scope"
  image: 
    secretName:
      __metadata:
        name: "Image Pull Secret Name"
        label: "Global Image Pull Secret Name"
        description: "The global image pull secret to authenticate with the image repository."
        type: "string"
        immutable: false
        required: false


## Netcool Object Server configuration
netcool:
  __metadata:
    label: "Object Server"
    description: "Object Server Configuration"
  primaryServer:
    __metadata:
      name: "primaryServer"
      label: "Primary Object Server Name"
      description: "The Primary Netcool/OMNIbus Object Server Name (usually set to NCOMS or AGG_P)."
      type: "string"
      immutable: false
      required: true
  primaryHost:
    __metadata:
      name: "primaryHost"
      label: "Primary Object Server Host"
      description: "The Primary Netcool/OMNIbus Object Server Hostname or IP address."
      type: "string"
      immutable: false
      required: true
  primaryPort:
    __metadata:
      name: "primaryPort"
      label: "Primary Object Server Port"
      description: "The Primary Netcool/OMNIbus Object Server Port number."
      type: "number"
      immutable: false
      required: true
  backupServer:
    __metadata:
      name: "backupServer"
      label: "Backup Object Server Name"
      description: >
        The Backup Netcool/OMNIbus Object Server Name. If the backupServer, backupHost 
        and backupPort parameters are defined in addition
        to the primaryServer, primaryHost, and primaryPort parameters, the probe
        will be configured to connect to a virtual object server pair called AGG_V.
      type: "string"
      immutable: false
      required: false
  backupHost:
    __metadata:
      name: "backupHost"
      label: "Backup Object Server Host"
      description: "The Backup Netcool/OMNIbus Object Server Hostname or IP address."
      type: "string"
      immutable: false
      required: false
  backupPort:
    __metadata:
      name: "backupPort"
      label: "Backup Object Server Port"
      description: "The Backup Netcool/OMNIbus Object Server Port number."
      type: "number"
      immutable: false
      required: false


## Probe configuration
probe:
  __metadata:
    label: "Probe Configuration"
    description: "Probe configuration parameters."
  messageLevel:
    __metadata:
      name: "messageLevel"
      label: "Probe Log Message Level"
      description: "The Probe log message level."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Fatal"
        value: "fatal"
      - label: "Error"
        value: "error"
      - label: "Warning"
        value: "warn"
      - label: "Info"
        value: "info"
      - label: "Debug"
        value: "debug"
  rulesFile:
    __metadata:
      name: "rulesFile"
      label: "Probe Rules File"
      description: "Specifies the rules files to use. Defaults to Standard"
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Standard Rules File"
        value: "standard"
      - label: "NCKL - Netcool Knowledge Library"
        value: "NCKL"
  snmpv3:
    snmpv3Only:
        __metadata:
          name: "snmpv3Only"
          label: "Allow SNMP v3 only."
          description: "Set to true to only allow SNMP v3 traps and informs."
          type: "boolean"
          required: false
    snmpConfigChangeDetectionInterval:
        __metadata:
          name: "snmpConfigChangeDetectionInterval"
          label: "SNMPV3 Config Change Detection Interval (in minutes)."
          description: "Configuration change detection interval (in minutes) between 0 to 10080. Set to 0 to disable."
          type: "number"
          required: false
    reuseEngineBoots:
        __metadata:
          name: "reuseEngineBoots"
          label: "Reuse Engine ID and the number of SNMP Engine Boots"
          description: "Set to true to reuse engine ID and number of SNMP boots."
          type: "boolean"
          required: true
    usmUserBase:
        __metadata:
          name: "usmUserBase"
          label: "USM User Base"
          description: "Specifies the location of of the mttrapd.conf file directory to load from. Default is 2."
          type: "string"
          required: false
          options:
          - label: "0 - Use files in ConfPath directory only"
            value: "0"
          - label: "1 - Use files in PersistentDir directory only"
            value: "1"
          - label: "2 - Use files in both ConfPath and PersistentDir directories"
            value: "2"
    snmpv3MinSecurityLevel:
        __metadata:
          name: "snmpv3MinSecurityLevel"
          label: "SNMP V3 Minimum Security Level"
          description: "Specify which SNMPv3 traps the SNMP Probe processes. By default the probe processes SNMPv3 traps of all security levels."
          type: "string"
          required: false
          options:
          - label: "1 - SNMP V3 Traps/Inform PDUs of security level NoAuth, AuthNoPriv, or AuthPriv."
            value: "1"
          - label: "2 - SNMP V3 Traps/Inform PDUs of security level AuthNoPriv or AuthPriv."
            value: "2"
          - label: "3 - SNMP V3 Traps/Inform PDUs of security level AuthPriv."
            value: "3"
    secretName:
        __metadata:
          name: "secretName"
          label: "Existing (pre-created) secret containing SNMP V3 USM Users list"
          description: "Leave empty to create a new secret taking the list defined in \"users\" parameter below."
          type: "string"
          required: false
    users:
        __metadata:
          name: "users"
          label: "SNMP V3 Users"
          description: "A list of SNMP V3 users. See README for sample value. Ignored if \"secretName\" is set (use existing secret)."
          type: "string"
          required: false
  

## Service configuration metadata
service:
  __metadata:
    label: "Service"
    description: "Kubernetes services"
  probe:
    type: 
      __metadata:
        name: "Type"
        label: "Probe Endpoint Service Type"
        description: "This is the Service Type for the Probe Endpoint to receive events."
        type: "string"
        immutable: false
        required: true
        options:
          - label: "Cluster IP"
            value: "ClusterIP"
          - label: "Node Port"
            value: "NodePort"
    externalPort: 
      __metadata:
        name: "externalPort"
        label: "External port"
        description: "This is the external port number"
        type: "number"
        immutable: false
        required: true

## Horizontal Pod Autoscaler settings
autoscaling:
  __metadata:
    label: "Horizontal Pod Auto-scaling Policy"
    description: "Probe Horizontal Pod Auto-scaling Policy"
  enabled:
    __metadata:
      label: "Enable Horizontal Pod autoscaling"
      description: "Pod will scale based on the autoscaling parameters"
      type: "boolean"
      required: false
  minReplicas:
    __metadata:
      label: "Minimum replicas"
      description: "Minimum number of probe replicas at any point in time"
      type: "number"
      required: false
  maxReplicas:
    __metadata:
      label: "Maximum replicas"
      description: "Maximum number of probe replicas at any point in time"
      type: "number"
      required: false
  cpuUtil:
    __metadata:
      label: "Target CPU utilization"
      description: "Target average CPU utilization (represented as a percentage of requested CPU) over all the pods." 
      type: "number"
      required: false
      
poddisruptionbudget:
  __metadata:
    label: "Pod Disruption Budget"
    description: "Pod Disruption Budget. Administrator role or higher is required to enable PDB."
  enabled:
    __metadata:
      label: "Enable Pod Disruption Budget"
      description: "Enables application protection availability during a cluster node maintenance."
      type: "boolean"
      required: false
  minAvailable:
    __metadata:
      label: "Minimum number of replicas"
      description: "Minimum number or percentage of probe replicas that must be available during pod eviction"
      type: "string"
      required: false

## Resource requests and limits configuration metadata
resources:
  __metadata:
    label: "Resources"
    description: "Required resources"
  requests:
    cpu: 
      __metadata: 
        label: "CPU request"
        description: "The requested CPU"
        type: "string"
        required: true   
    memory: 
      __metadata: 
        label: "Memory request"
        description: "The memory request"
        type: "string"
        required: true   
  limits:
    cpu: 
      __metadata: 
        label: "CPU limit"
        description: "The CPU limit"
        type: "string"
        required: true   
    memory: 
      __metadata: 
        label: "Memory limit"
        description: "The memory limit"
        type: "string"
        required: true   
