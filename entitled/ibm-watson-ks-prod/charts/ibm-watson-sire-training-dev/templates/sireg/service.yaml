{{- include "sch.config.init" (list . "sireTraining.sch.chart.config.values") -}}
{{- $sireg := .Values.sireg -}}
{{- $rootContext := . -}}
{{- if $sireg.enabled -}}
{{- range $langKey, $langValue := $sireg.languages -}}
{{- $compName :=  (printf "sireg-%s" $langKey) -}}
{{- if $langValue.enabled -}}
apiVersion: v1
kind: Service
metadata:
  name: {{ include $sireg.endpointTpl (list $ $langKey) }}
  labels:
{{ include "sch.metadata.labels.standard" (list $ $compName) | indent 4 }}
spec:
  type: ClusterIP
  ports:
  - name: grpc
    port: {{ $sireg.securePort }}
    protocol: TCP
    targetPort: sireg-sec-port
  selector:
{{ include "sch.metadata.labels.standard" (list $ $compName) | indent 4 }}
---
{{- end -}}
{{- end -}}
{{- end -}}