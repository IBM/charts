{{- if and (not .Values.privilegedServiceAccount.name) (not (.Capabilities.APIVersions.Has "security.openshift.io/v1")) }}
{{- include "sch.config.init" (list . .Values.schConfigName) -}}
apiVersion: v1
kind: ServiceAccount
imagePullSecrets:
{{- if not (.Capabilities.APIVersions.Has "security.openshift.io/v1") }}
- name: sa-{{ .Release.Namespace }}
{{- end }}
{{- if tpl (.Values.global.imagePullSecretName | toString ) . }}
- name: {{ tpl (.Values.global.imagePullSecretName | toString ) . }}
{{- end }}
metadata:
  name: {{ include "wcn-addon.privileged-account.name" . }}
  annotations:
    "helm.sh/hook": "pre-install"
    "helm.sh/hook-weight": "-100"
    "helm.sh/hook-delete-policy": "hook-failed,before-hook-creation"
  namespace: "{{ .Release.Namespace }}"
  labels:
{{ include "sch.metadata.labels.standard" (list . "addon") | indent 4 }}
{{- end }}