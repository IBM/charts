apiVersion: v1
kind: ConfigMap
metadata:
  name: "{{ .Release.Name }}-master-config"
  labels:
    service:   "conversation"
    component: "master"
    slot:      "{{ .Release.Name }}"
    app: "ibm-watson-assistant-prod-1.3.0"
    chart: "ibm-watson-assistant"
    heritage: "{{ .Release.Service }}"
    release: "{{ .Release.Name }}"
data:
  master-config.properties: |
    bluegoat.master.pagerduty_url=https://events.pagerduty.com/generic/2010-04-15/create_event.json
  
  job-pod.json: |
    {
    "kind": "Pod",
    "apiVersion": "v1",
    "metadata": {
        "labels": { }
    },
    "spec": {
        "terminationGracePeriodSeconds": 3,
        "containers": [{
                "command": ["/opt/bluegoat/service/ascscripts/train.sh"],
                "env": [],
                "volumeMounts": [
                    {
                        "name":      "cos-certificate",
                        "mountPath": "/etc/secrets/cos/",
                        "readOnly":  true
                    }
                ],
                "resources": {
                    "requests": {},
                    "limits": {}
                }
            }],
        "imagePullSecrets": [],
        "volumes": [
            {
                "name":      "cos-certificate",
                "secret": {
                    "secretName": "{{ include "assistant.cos.tls.secretName" . }}",
                    "defaultMode": 420,
                    "items": [
                        {
                            "key": "ca.crt",
                            "path": "ca.crt"
                        }
                    ]
                }
            }
        ],
        "restartPolicy": "Never"
    }
    }