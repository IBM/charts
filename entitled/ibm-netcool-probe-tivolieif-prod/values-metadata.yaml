## Metadata for the IBM Netcool/OMNIBus Tivoli EIF probe configuration
## This metadata is used to augment the value.yaml to drive IPC UI for configuration of the Helm chart installation


## License acceptance
license:
  __metadata:
    name: "license"
    label: "Docker image license acceptance"
    description: "Must be set to \"accept\" to proceed with installation. Defaults to Not Accepted."
    type: "string"
    immutable: false
    required: true
    hidden: false
    options:
    - label: "Not Accepted"
      value: "not accepted"
    - label: "Accept"
      value: "accept"


arch:
 __metadata:
   name: "Architecture"
   label: "Worker node architecture"
   description: "Worker node architecture to deploy to. Supports AMD64 architecture only."
   type: "string"
   required: true
   options:
     - label: "AMD64"
       value: "amd64"


## Replica count configuration metadata
replicaCount: 
  __metadata:
    name: "replicaCount"
    label: "Replica Count"
    description: "Deployment replicaCount - optional field dependent on workload"
    type: "number"
    immutable: false
    required: false


global:
  __metadata:
    label: "Global Configuration"
    description: "The Global Configuration"
  image: 
    secretName:
      __metadata:
        name: "Image Pull Secret Name"
        label: "Global Image Pull Secret Name"
        description: "The name of the respective secret name returned from kubectl get secret."
        type: "string"
        immutable: false
        required: false 


## Image configuration metadata
image:
  __metadata:
    label: "Docker image"
    description: "Docker Image Configuration"
  repository:
    __metadata:
      name: "repository"
      label: "Docker Image Repository"
      description: "Docker image repository. The image name should be set to \"netcool-probe-tivolieif\"."
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      name: "tag"
      label: "Docker Image Tag"
      description: "Specific image tag to use."
      type: "string"
      immutable: false
      required: true
  testRepository:
    __metadata:
      name: "testRepository"
      label: "Test Image Repository"
      description: "Docker image repository for the test image."
      type: "string"
      immutable: false
      required: true
  testImageTag:
    __metadata:
      name: "testImageTag"
      label: "Docker test image tag"
      description: "Specific image tag to use for the test image"
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Docker Image Pull Policy"
      description: "Always, Never, or IfNotPresent. Defaults to IfNotPresent."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
      - label: "IfNotPresent"
        value: "IfNotPresent"


# Netcool Object Server configuration
netcool:
  __metadata:
    label: "Object Server Configuration"
    description: "The Object Server Configuration"
  primaryServer:
    __metadata:
      name: "primaryServer"
      label: "Primary Object Server Name"
      description: "The Primary Netcool/OMNIbus Object Server Name."
      type: "string"
      immutable: false
      required: true
  primaryHost:
    __metadata:
      name: "primaryHost"
      label: "Primary Object Server Host"
      description: "The Primary Netcool/OMNIbus Object Server Hostname or IP address."
      type: "string"
      immutable: false
      required: true
  primaryPort:
    __metadata:
      name: "primaryPort"
      label: "Primary Object Server Port"
      description: "The Primary Netcool/OMNIbus Object Server Port number."
      type: "number"
      immutable: false
      required: true
  backupServer:
    __metadata:
      name: "backupServer"
      label: "Backup Object Server Name"
      description: >
        The Backup Netcool/OMNIbus Object Server Name. If the backupServer, backupHost 
        and backupPort parameters are defined in addition
        to the primaryServer, primaryHost, and primaryPort parameters, the probe
        will be configured to connect to a virtual object server pair called AGG_V.
      type: "string"
      immutable: false
      required: false
  backupHost:
    __metadata:
      name: "backupHost"
      label: "Backup Object Server Host"
      description: "The Backup Netcool/OMNIbus Object Server Hostname or IP address."
      type: "string"
      immutable: false
      required: false
  backupPort:
    __metadata:
      name: "backupPort"
      label: "Backup Object Server Port"
      description: "The Backup Netcool/OMNIbus Object Server Port number. Default is empty."
      type: "number"
      immutable: false
      required: false


## Probe configuration
probe:
  __metadata:
    label: "Probe Configuration"
    description: "The Probe Configuration"
  messageLevel:
    __metadata:
      name: "messageLevel"
      label: "Probe Log Message Level"
      description: "The Probe log message level."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Fatal"
        value: "fatal"
      - label: "Error"
        value: "error"
      - label: "Warning"
        value: "warn"
      - label: "Info"
        value: "info"
      - label: "Debug"
        value: "debug"
  rulesFile:
    taddm:
      __metadata:
        label: "TADDM"
        description: "Enable Tivoli Application Dependency Discovery Manager rules"
        type: "boolean"
        required: false
    tpc:
      __metadata:
        label: "TPC"
        description: "Enable Tivoli Storage Productivity Center rules"
        type: "boolean"
        required: false
    tsm:
      __metadata:
        label: "TSM"
        description: "Enable Tivoli Storage Manager rules"
        type: "boolean"
        required: false


## Service configuration metadata
service:
  __metadata:
    label: "Service Configuration"
    description: "The Service Configuration"
  probe:
    type: 
      __metadata:
        name: "Type"
        label: "Service Type"
        description: "Probe Service Type"
        type: "string"
        immutable: false
        required: true
        options:
          - label: "Cluster IP"
            value: "ClusterIP"
          - label: "Node Port"
            value: "NodePort"
    externalPort: 
      __metadata:
        name: "externalPort"
        label: "External port"
        description: "This is the external port number"
        type: "number"
        immutable: false
        required: true

autoscaling:
  __metadata:
    label: "Probe auto-scaling policy"
    description: "The Probe auto-scaling policy"
  enabled:
    __metadata:
      label: "Enable Horizontal Pod autoscaling"
      description: "Pod will scale based on the autoscaling parameters"
      type: "boolean"
      required: false
  minReplicas:
    __metadata:
      label: "Minimum replicas"
      description: "Minumum number of probe replicas at any point in time"
      type: "number"
      required: false
  maxReplicas:
    __metadata:
      label: "Maximum replicas"
      description: "Maximum number of probe replicas at any point in time"
      type: "number"
      required: false
  cpuUtil:
    __metadata:
      label: "Target CPU utilization"
      description: "Target average CPU utilization (represented as a percentage of requested CPU) over all the pods. Eg: Set to 60 for 60% target utilization." 
      type: "number"
      required: false
poddisruptionbudget:
  __metadata:
    label: "Pod Disruption Budget"
    description: "The Pod Disruption Budget"
  enabled:
    __metadata:
      label: "Enable Pod Disruption Budget"
      description: "Enables application protection availability during a cluster node maintenance. Administrator role or higher required to enable PDB."
      type: "boolean"
      required: false
  minAvailable:
    __metadata:
      label: "Minumum number of replicas"
      description: "Minumum number of probe replicas that must be available during pod eviction"
      type: "string"
      required: false

## Resource requests and limits configuration metadata
resources:
  __metadata:
    label: "Resources"
    description: "The Resources"
  requests:
    cpu: 
      __metadata: 
        label: "CPU request"
        description: "The requested CPU"
        type: "string"
        required: true   
    memory: 
      __metadata: 
        label: "Memory request"
        description: "The memory request"
        type: "string"
        required: true   
  limits:
    cpu: 
      __metadata: 
        label: "CPU limit"
        description: "The CPU limit"
        type: "string"
        required: true   
    memory: 
      __metadata: 
        label: "Memory limit"
        description: "The memory limit"
        type: "string"
        required: true   
