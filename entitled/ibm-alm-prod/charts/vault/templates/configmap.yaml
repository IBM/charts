{{- include "sch.config.init" (list . "alm.sch.chart.config.values") -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: "{{ include "sch.names.fullName" (list .) }}"
  labels:
{{ include "sch.metadata.labels.standard" (list . "") | indent 4 }}
data:
  config.json: |-
    {
      "cluster_name": "{{ .Release.Name }}-vault",
      {{- if .Values.swapIsDisabled }}
      "disable_mlock": true,
      {{- end }}
      "storage":{
        "zookeeper": {
          "address": "{{ include "zookeeper.getServerList" . | trimSuffix ","  }}",
          "path": "vault-data/"
        }
      },
      "listener": [
        {
          "tcp": {
            "address": "0.0.0.0:8200",
            "tls_disable": 0,
            "tls_cert_file": "/vault/certs/vault.cer",
            "tls_key_file": "/vault/certs/vault.key"
          }
        }
      ],
      "ui": false
    }
