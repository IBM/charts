## This metadata is used to augment the value.yaml to drive ICP UI for configuration of the Helm chart installation

###################
# Common Parameters
###################

## License acceptance
license:
  __metadata:
    name: "license"
    label: "Docker image license acceptance"
    description: "Must be set to \"accept\" to proceed with installation. Defaults to Not Accepted."
    type: "string"
    immutable: false
    required: true
    hidden: false
    options:
    - label: "Not Accepted"
      value: "not accepted"
    - label: "Accept"
      value: "accept"

## Image configuration metadata
image:
  __metadata:
      label: "Docker Image"
      name: "image"
      description: "Docker Image Configuration"
  repository:
    __metadata:
      name: "repository"
      label: "Probe Image Repository"
      description: Docker registry to pull "netcool-probe-messagebus" image from. The image name must be "netcool-probe-messagebus".
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      name: "tag"
      label: "Image tag"
      description: "Specific image tag to use. A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
      type: "string"
      immutable: false
      required: true
  testRepository:
    __metadata:
      name: "testRepository"
      label: "Test Image Repository"
      description: Docker registry to pull "netcool-integration-util" image from. The image name must be "netcool-integration-util".
      type: "string"
      immutable: false
      required: true
  testImageTag:
    __metadata:
      name: "testImageTag"
      label: "Docker Test Image tag"
      description: "Specific image tag to use. for the test image. A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Docker Image Pull Policy"
      description: "The default pull policy is Always which causes the Kubelet to always pull the image."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
      - label: "IfNotPresent"
        value: "IfNotPresent"

## Global value explicit declaration
global:
  __metadata:
    label: "Docker-registry secret"
    name: "global"
    description: "Specifies a secret resource containing an image pull secret to authenticate with the docker registry."
  image:
    secretName:
      __metadata:
        label: "Secret Name"
        description: >
          Name of the Secret containing the Docker Config to pull image from a private repository. 
          Leave blank if the probe image already exists in the local image repository or 
          the Service Account has been assigned with an Image Pull Secret.
        type: "string"
        required: false
  serviceAccountName:
    __metadata:
      label: "Service Account Name"
      description: >
        If the Cluster Administrator has already created a service account in the namespace, specify the name of the service account here.
        If left blank, the chart will automatically create a new service account in the namespace when it is deployed. This new service account will be removed from
        the namespace when the chart is removed.
      type: "string"
      required: false


## Netcool Object Server configuration
netcool:
  __metadata:
    label: "Object Server Configuration"
    name: "netcool"
    description: "Configures the probe and Object Server communication parameters."
  connectionMode:
    __metadata:
      name: "connectionMode"
      label: "Connection Mode"
      description: > 
        The connection mode when establishing a connection with the Object Server.
        Requires a pre-created secret containing files/values for secured communication except for "Default" mode.
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Default - Authentication and SSL disabled."
        value: "Default"
      - label: "AuthOnly - Authentication enabled only."
        value: "AuthOnly"
      - label: "SSLOnly - SSL enabled only."
        value: "SSLOnly"
      - label: "SSLAndAuth - SSL and authentication enabled."
        value: "SSLAndAuth"
  primaryServer:
    __metadata:
      name: "primaryServer"
      label: "Primary Object Server Name"
      description: "The Primary Netcool/OMNIbus Object Server Name (usually set to NCOMS or AGG_P)."
      type: "string"
      immutable: false
      required: true
  primaryHost:
    __metadata:
      name: "primaryHost"
      label: "Primary Object Server Host"
      description: "The Primary Netcool/OMNIbus Object Server Hostname or IP address."
      type: "string"
      immutable: false
      required: true
  primaryPort:
    __metadata:
      name: "primaryPort"
      label: "Primary Object Server Port"
      description: "The Primary Netcool/OMNIbus Object Server Port number."
      type: "number"
      immutable: false
      required: true
  backupServer:
    __metadata:
      name: "backupServer"
      label: "Backup Object Server Name"
      description: >
        The Backup Netcool/OMNIbus Object Server Name. If the backupServer, backupHost 
        and backupPort parameters are defined in addition
        to the primaryServer, primaryHost, and primaryPort parameters, the probe
        will be configured to connect to a virtual object server pair called AGG_V.
      type: "string"
      immutable: false
      required: false
  backupHost:
    __metadata:
      name: "backupHost"
      label: "Backup Object Server Host"
      description: "The Backup Netcool/OMNIbus Object Server Hostname or IP address."
      type: "string"
      immutable: false
      required: false
  backupPort:
    __metadata:
      name: "backupPort"
      label: "Backup Object Server Port"
      description: "The Backup Netcool/OMNIbus Object Server Port number."
      type: "number"
      immutable: false
      required: false
  secretName:
    __metadata:
      name: "secretName"
      label: "Probe-Server Communication Secret"
      description: "Secret containing the required files/values for secured communication."
      type: "string"
      immutable: false
      required: false

## Common Probe configuration
probe:
  __metadata:
    label: "Common Probe Configuration"
    name: "probe"
    description: "This configuration will be applied to both Prometheus and Logstash Probes"
  messageLevel:
    __metadata:
      name: "messageLevel"
      label: "Probe Log Message Level"
      description: "The Probe log message level."
      type: "string"
      immutable: false
      required: false
      options:
      - label: "Fatal"
        value: "fatal"
      - label: "Error"
        value: "error"
      - label: "Warning"
        value: "warn"
      - label: "Info"
        value: "info"
      - label: "Debug"
        value: "debug"
  setUIDandGID:
    __metadata:
      label: "Set the User ID and Group ID for the Probe process"
      description: >
        The probe processes in the container are run by the netcool user. When set to true, the helm chart will specify the UID and GID values to 
        be assigned to the netcool user. Otherwise if false, the netcool user will not be assigned any UID or GID by the helm chart.
      type: "boolean"
      required: true
  sslServerCommonName:
    __metadata:
      name: "sslServerCommonName"
      label: "SSL Server Common Names"
      description: "A comma-separated list of acceptable SSL Common Names when connecting to Object Server using SSL."
      type: "string"
      immutable: false
      required: false
  locale:
    __metadata:
      name: "locale"
      label: "Environment Locale Setting"
      description: "Used as the LC_ALL environment variable."
      type: "string"
      immutable: false
      required: false


###########################
# Logstash Probe Parameters
###########################
logstashProbe:
  __metadata:
    label: "Logstash Probe Configuration"
    name: "logstashProbe"
    description: "This configuration will be applied to the Logstash probe."
  enabled:
    __metadata:
      label: "Enable Logstash Probe"
      description: "Set to true to enable Logstash Probe"
      type: "boolean"
      required: true
  ## Replica count configuration metadata
  replicaCount:
    __metadata:
      name: "replicaCount"
      label: "Replica Count"
      description: "Deployment replicaCount should be set if Horizontal Pod Autoscaling is disabled."
      type: "number"
      immutable: false
      required: false
      
  service:
    type:
      __metadata:
        name: "Type"
        label: "Service Type"
        description: "An API object that describes how to access applications, such as a set of Pods, and can describe ports and load-balancers."
        type: "string"
        immutable: false
        required: true
        options:
          - label: "ClusterIP"
            value: "ClusterIP"
          - label: "NodePort"
            value: "NodePort"

    externalPort:
      __metadata:
        name: "externalPort"
        label: "External port"
        description: "This is the external port number"
        type: "number"
        immutable: false
        required: true
  ingress:
    enabled:
      __metadata:
        label: "Ingress Enabled"
        description: "Enable ingress to allow external traffic to reach the probe service"
        type: "boolean"
        required: true
    hosts:
      __metadata:
        label: "Name-based virtual hosts"
        description: "Name-based virtual hosts for the Logstash Probe. The Helm release name will be appended as a prefix to make each virtual hosts unique."
        type: "string"
        required: false
  autoscaling:
    enabled:
      __metadata:
        label: "Enable Horizontal Pod autoscaling"
        description: "Pod will scale based on the autoscaling parameters"
        type: "boolean"
        required: false
    minReplicas:
      __metadata:
        label: "Minimum replicas"
        description: "Minimum number of probe replicas at any point in time"
        type: "number"
        required: false
    maxReplicas:
      __metadata:
        label: "Maximum replicas"
        description: "Maximum number of probe replicas at any point in time"
        type: "number"
        required: false
    cpuUtil:
      __metadata:
        label: "Target CPU utilization"
        description: "Target average CPU utilization (represented as a percentage of requested CPU) over all the pods. Eg: Set to 60 for 60% target utilization." 
        type: "number"
        required: false
  poddisruptionbudget:
    enabled:
      __metadata:
        label: "Enable Pod Disruption Budget"
        description: "Enables application protection availability during a cluster node maintenance. Administrator role or higher required to enable PDB."
        type: "boolean"
        required: false
    minAvailable:
      __metadata:
        label: "Minimum number of replicas"
        description: "Minimum number of probe replicas that must be available during pod eviction"
        type: "string"
        required: false


###########################
# Prometheu Probe Parameters
###########################
prometheusProbe:
  __metadata:
    label: "Prometheus Probe Configuration"
    name: "prometheusProbe"
    description: "This configuration will be applied to the Prometheus probe."
  enabled:
    __metadata:
      label: "Enable Prometheus Probe"
      description: "Set to true to enable Prometheus Probe"
      type: "boolean"
      required: true
  # Replica count configuration metadata
  replicaCount:
    __metadata:
      name: "replicaCount"
      label: "Replica Count"
      description: "Deployment replicaCount should be set if Horizontal Pod Autoscaling is disabled."
      type: "number"
      immutable: false
      required: false
      
  service:
    type:
      __metadata:
        name: "Type"
        label: "Service Type"
        description: "An API object that describes how to access applications, such as a set of Pods, and can describe ports and load-balancers."
        type: "string"
        immutable: false
        required: true
        options:
          - label: "ClusterIP"
            value: "ClusterIP"
          - label: "NodePort"
            value: "NodePort"

    externalPort:
      __metadata:
        name: "externalPort"
        label: "External port"
        description: "This is the external port number"
        type: "number"
        immutable: false
        required: true
## Ingress configuration enablement metadata
  ingress:
    enabled:
      __metadata:
        label: "Ingress Enabled"
        description: "Enable ingress to allow external traffic to reach the probe service"
        type: "boolean"
        required: true
    hosts:
      __metadata:
        label: "Name-based virtual hosts"
        description: "Name-based virtual hosts for the Prometheus Probe. The Helm release name will be appended as a prefix to make each virtual hosts unique."
        type: "string"
        required: false
  autoscaling:
    enabled:
      __metadata:
        label: "Enable Horizontal Pod autoscaling"
        description: "Pod will scale based on the autoscaling parameters"
        type: "boolean"
        required: false
    minReplicas:
      __metadata:
        label: "Minimum replicas"
        description: "Minimum number of probe replicas at any point in time"
        type: "number"
        required: false
    maxReplicas:
      __metadata:
        label: "Maximum replicas"
        description: "Maximum number of probe replicas at any point in time"
        type: "number"
        required: false
    cpuUtil:
      __metadata:
        label: "Target CPU utilization"
        description: "Target average CPU utilization (represented as a percentage of requested CPU) over all the pods. Eg: Set to 60 for 60% target utilization." 
        type: "number"
        required: false
  poddisruptionbudget:
    enabled:
      __metadata:
        label: "Enable Pod Disruption Budget"
        description: "Enables application protection availability during a cluster node maintenance. Administrator role or higher required to enable PDB."
        type: "boolean"
        required: false
    minAvailable:
      __metadata:
        label: "Minimum number of replicas"
        description: "Minimum number or percentage of probe replicas that must be available during pod eviction"
        type: "string"
        required: false

###########################
# CEM Probe Parameters
###########################
cemProbe:
  __metadata:
    label: "CEM Probe Configuration"
    name: "cemProbe"
    description: "This configuration will be applied to the CEM probe."
  enabled:
    __metadata:
      label: "Enable CEM Probe"
      description: "Set to true to enable CEM Probe"
      type: "boolean"
      required: true

  replicaCount:
    __metadata:
      name: "replicaCount"
      label: "Replica Count"
      description: "Deployment replicaCount should be set if Horizontal Pod Autoscaling is disabled."
      type: "number"
      immutable: false
      required: false
      
  service:
    type:
      __metadata:
        name: "Type"
        label: "Service Type"
        description: "An API object that describes how to access applications, such as a set of Pods, and can describe ports and load-balancers."
        type: "string"
        immutable: false
        required: true
        options:
          - label: "ClusterIP"
            value: "ClusterIP"
          - label: "NodePort"
            value: "NodePort"

    externalPort:
      __metadata:
        name: "externalPort"
        label: "External port"
        description: "This is the external port number"
        type: "number"
        immutable: false
        required: true

  autoscaling:
    enabled:
      __metadata:
        label: "Enable Horizontal Pod autoscaling"
        description: "Pod will scale based on the autoscaling parameters"
        type: "boolean"
        required: false
    minReplicas:
      __metadata:
        label: "Minimum replicas"
        description: "Minimum number of probe replicas at any point in time"
        type: "number"
        required: false
    maxReplicas:
      __metadata:
        label: "Maximum replicas"
        description: "Maximum number of probe replicas at any point in time"
        type: "number"
        required: false
    cpuUtil:
      __metadata:
        label: "Target CPU utilization"
        description: "Target average CPU utilization (represented as a percentage of requested CPU) over all the pods. Eg: Set to 60 for 60% target utilization." 
        type: "number"
        required: false
  poddisruptionbudget:
    enabled:
      __metadata:
        label: "Enable Pod Disruption Budget"
        description: "Enables application protection availability during a cluster node maintenance. Administrator role or higher required to enable PDB."
        type: "boolean"
        required: false
    minAvailable:
      __metadata:
        label: "Minimum number of replicas"
        description: "Minimum number or percentage of probe replicas that must be available during pod eviction"
        type: "string"
        required: false


###########################
# Common Resource Parameters
###########################
## Resource requests and limits configuration metadata
resources:
  __metadata:
    label: "Resource quotas"
    name: "resources"
    description: "Configures resource allocation and limits for the probes."
  requests:
    cpu:
      __metadata:
        label: "CPU request"
        description: "The minimum required CPU core. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true
    memory:
      __metadata:
        label: "Memory request"
        description: "The minimum memory in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: true
  limits:
    cpu:
      __metadata:
        label: "CPU limit"
        description: "The upper limit of CPU core. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true
    memory:
      __metadata:
        label: "Memory limit"
        description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: true

arch:
 __metadata:
   name: "Architecture"
   label: "Architecture scheduling preferences"
   description: "Targets a specific OS to use for the worker node. (Supports AMD64 architecture only.)"
   type: "string"
   immutable: true
   required: true
   options:
     - label: 'AMD64 platforms'
       value: "amd64"

