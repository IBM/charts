## Metadata for IIRA configuration
## This metadata is used to drive IBM Cloud Private UI for configuration of the Helm chart installation

## Image configuration metadata
image:
  __metadata:
    label: "Image"
    description: "Stored instance of a container that holds a set of software needed to run an application."
  repository:
    __metadata:
      label: "<component> image Repository"
      description: "Docker registry to pull <component> image from"
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      label: "Image tag"
      description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      label: "Image pull policy"
      description: "The default pull policy is IfNotPresent which causes the Kubelet to skip pulling an image if it already exists."
      type: "string"
      immutable: false
      required: true
      options:
      - label: 'Always'
        value: 'Always'
      - label: 'Never'
        value: 'Never'
      - label: 'IfNotPresent'
        value: 'IfNotPresent'

## Service configuration metadata
service:
  __metadata:
    label: "Service"
    description: "Service label for configuration"
  type:
    __metadata:
      label: "Service type"
      description: "An API object that describes how to access applications, such as a set of Pods, and can describe ports and load-balancers."
      type: "string"
      immutable: false
      required: true
      options:
      - label: 'ClusterIP'
        value: 'ClusterIP'
      - label: 'NodePort'
        value: 'NodePort'
      - label: 'LoadBalancer'
        value: 'LoadBalancer'
      - label: 'ExternalName'
        value: 'ExternalName'
  externalPort:
    __metadata:
      label: "External port"
      description: "This is the external port number"
      type: "number"
      immutable: false
      required: true

resources:
  __metadata:
    description: "Resource settings"
    label: "Resource quotas"
  requests:
    cpu:
      __metadata:
        label: "CPU request"
        description: "The minimum required CPU core. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true
    memory:
      __metadata:
        label: "Memory request"
        description: "The minimum memory in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: true
  limits:
    cpu:
      __metadata:
        label: "CPU limit"
        description: "The upper limit of CPU core. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true
    memory:
      __metadata:
        label: "Memory limit"
        description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: true

autoscaling:
  __metadata:
    label: "Autoscaling"
    description: "Automatically scale pods"
  minReplicas:
    __metadata:
      name: "minReplicas"
      label: "Minimum number of replicas"
      description: "Lower limit for the number of pods that can be set by the autoscaler."
      type: "number"
      immutable: false
      required: true
  maxReplicas:
    __metadata:
      name: "maxReplicas"
      label: "Maximum number of replicas"
      description: "Upper limit for the number of pods that can be set by the autoscaler.  Cannot be lower than the minimum number of replicas."
      type: "number"
      immutable: false
      required: true
  targetCPUUtilizationPercentage:
    __metadata:
      name: "targetCPUUtilizationPercentage"
      label: "Target CPU utilization percentage"
      description: "Target average CPU utilization (represented as a percentage of requested CPU) over all the pods."
      type: "number"
      immutable: false
      required: true

# Persistence
# Uncomment if applicable
#persistence:
#  __metadata:
#    label: "Persistence configuration"
#  enabled:
#    __metadata:
#      label: "Enable persistence storage for the <component>"
#      description: "Select this checkbox to store <component> data on a persistent volume so that the data is preserved if the pod is stopped."
#  useDynamicProvisioning:
#    __metadata:
#      label: "Use dynamic provisioning"
#      description: "Select this checkbox to allow the cluster to automatically provision new storage resource and create PersistentVolume objects."

## Replica count configuration metadata
replicaCount:
  __metadata:
    label: "Replica count"
    description: "Deployment replicaCount - optional field dependent on workload"
    type: "number"
    immutable: false
    required: false

## Ingress configuration enablement metadata
ingress:
  __metadata:
    label: "Ingress"
    description: "Ingress label for configuration"
  enabled:
    __metadata:
      label: "Ingress enabled"
      description: "This option enables boolean ingress"
      type: "boolean"
      required: true
  hosts:
      __metadata:
        label: "Host location for the chart"
        description: "Helps identify placement of chart"
        type: "string"
        required: true
  tls:
    __metadata:
      label: "tls method for ingress"
      description: "This helps with generating ingress secrets"
      type: "string"
      required: false
## Dashboard configuration enablement metadata
dashboardEnabled:
    __metadata:
      label: "Deploy the dashboard to grafana"
      description: "Automatically deploy the dashboard into grafana"
      type: "boolean"
      hidden: true
