################################################################################
# Licensed Materials - Property of IBM
#
# (C) Copyright IBM Corp. 2019. All Rights Reserved.
#
# US Government Users Restricted Rights - Use, duplication or
# disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
#
################################################################################
{{ include "sch.config.init" (list . "sch.appengine.config.values") }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "sch.names.fullCompName" (list . "env") }}
  labels:
{{ include "sch.metadata.labels.standard" (list . "env") | indent 4 }}

data:
    MODEL_DIRECTORY: ""
    CSP_ENABLED: {{ .Values.contentSecurityPolicy.enable | quote }}
    SERVER_ENV_TYPE: {{ .Values.env.serverEnvType | quote }}
    CSP_WHITELIST: {{ .Values.contentSecurityPolicy.whitelist | quote }}
    STATIC_ASSET_MAXAGE: {{ .Values.maxAge.staticAsset | quote }}
    OPENID_ISSUER: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oidc/endpoint/ums"
    OPENID_AUTHORIZATION_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oidc/endpoint/ums/authorize"
    OPENID_TOKEN_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oidc/endpoint/ums/token"
    OPENID_CALLBACK_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.appEngine "appengine")}}/auth/openidconnect/callback"
    OPENID_INTROSPECTION_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oidc/endpoint/ums/introspect"
    OPENID_TOKEN_REFRESH_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oauth2/endpoint/oidcOAuthProvider/token"
    OPENID_LOGOUT_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oidc/endpoint/ums/logout"
    OPENID_JWK_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/oidc/endpoint/ums/jwk"
    OPENID_SCOPE: "openid profile email address"
    TEAM_SERVER_GRAPH_QL_URL: "{{ include "solution-server-chart.serviceURL" (list .Values.global.ums "ums")}}/teamserver/rest/graphql"
    SESSION_DURATION: {{ .Values.session.duration | quote }}
    SESSION_RESAVE: {{ .Values.session.resave | quote }}
    SESSION_ROLLING: {{ .Values.session.rolling | quote }}
    SESSION_SAVE_UNINITIALEZED: {{ .Values.session.saveUninitialized | quote }}
    SESSION_USE_EXTERNAL_STORE: {{ .Values.session.useExternalStore | quote }}
    CSRF_COOKIE_MAXAGE: {{ .Values.maxAge.csrfCookie | quote }}
    REDIS_HOST: {{ .Values.redis.host | quote }}
    REDIS_PORT: {{ .Values.redis.port | quote }}
    REDIS_TTL: {{ .Values.redis.ttl | quote }}
    AUTHENTICATION_COOKIE_MAXAGE: {{ .Values.maxAge.authCookie | quote }}
    RESOURCE_REGISTRY_HOSTNAME: {{ .Values.global.resourceRegistry.hostname | quote}}
    RESOURCE_REGISTRY_PORT: {{ .Values.global.resourceRegistry.port | quote}}
    RESOURCE_REGISTRY_URL: "/rest/bpm/wle/v1/apps/resolveAppResource"
    LRU_CACHE_MAX_SIZE_RR: {{ .Values.env.maxSizeLRUCacheRR | quote}}
    AE_DATABASE_NAME: {{ .Values.database.name | quote}}
    AE_DATABASE_HOST: {{ .Values.database.host | quote}}
    AE_DATABASE_PORT: {{ .Values.database.port | quote}}
    AE_DATABASE_TYPE: {{ .Values.database.type | quote}}
    AE_DATABASE_PROTOCOL: "TCPIP"
    AE_DATABASE_CURRENT_SCHEMA: {{ .Values.database.currentSchema | quote}}
    AE_DATABASE_POOL_SIZE_INIT: {{ .Values.database.initialPoolSize | quote}}
    UV_THREADPOOL_SIZE: {{ .Values.database.uvThreadPoolSize | quote}}
    LRU_CACHE_MAX_SIZE_DB: {{ .Values.database.maxLRUCacheSize | quote}}
    LRU_CACHE_MAX_AGE_DB: {{ .Values.database.maxLRUCacheAge | quote}}
    ACTION_CONFIGURATOR_TARGET_ORIGIN: {{ include "solution-server-chart.serviceURL" (list .Values.global.baStudio "bastudio")}}
    PUBLIC_HOSTNAME: {{ .Values.global.appEngine.hostname | quote}}
    PUBLIC_HTTPS_PORT: {{ .Values.global.appEngine.port | quote}}
    SESSION_CHECK_PERIOD: {{ .Values.session.checkPeriod | quote}}
    SESSION_MAX: {{ .Values.session.max | quote}}
