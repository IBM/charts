replicas: 
  __metadata:
    label: "Size of Replica Set"
    description: "Defaults to 3 nodes Replica Set. Input desired number of nodes."
    type: "number"
    required: true

port:
  __metadata:
    label: "MongoDB Port"
    description: "Defaults 27017. Input a number from 1001 to 65535."
    type: "number"
    required: true

replicaSetName: 
  __metadata:
    label: "Replica Set Name"
    description: "Defaults 'rs0'. Must be same as the replica set name in configmap(if used)"
    type: "string"
    required: true

creds: 
  image:
    name:
      __metadata:
        label: "Creds gen image name"
        description: "Docker image name to be pulled for creds gen"
    tag:
      __metadata:
        label: "Image tag"
        description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
  __metadata:
    label: "Image"
    description: "Stored instance of a container that holds a set of software needed to run an application."

config:
  __metadata:
    label: "Config copy image configuration"
    description: "Docker image for the init container copy config that establishes the replica set."
  image:
    name:
      __metadata:
        label: "Config copy image name"
        description: "Docker image name to be pulled for Mongodb config copy"
        type: "string"
        required: true
    tag:
      __metadata:
        label: "Image tag"
        description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
        type: "string"
        required: true

mongodbInstall:
  __metadata:
    label: "Mongodb install image configuration"
    description: "Docker image for the init container that establishes the replica set."
  image:
    name:
      __metadata:
        label: "Mongodb install image name"
        description: "Docker image name to be pulled for Mongodb install"
        type: "string"
        required: true
    tag:
      __metadata:
        label: "Image tag"
        description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
        type: "string"
        required: true

mongodb:
  __metadata:
    label: "Mongodb image configuration"
    description: "MongoDB Container's Docker Image Configuration"
  image:
    name: 
      __metadata:
        name: "name"
        label: "MongoDB Docker image name"
        description: "Docker image name to be pulled for Mongodb"
        type: "string"
        required: true
    tag: 
      __metadata:
        label: "Image tag"
        description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
        type: "string"
        required: true

test:
  __metadata:
    label: "Test framework image configuration"
    description: "Test framework Container's Docker image configuration"
  image:
    name: 
      __metadata:
        name: "name"
        label: "Bats Docker image name"
        description: "Docker image name to be pulled for helm tests"
        type: "string"
        required: true
    tag: 
      __metadata:
        label: "Image tag"
        description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
        type: "string"
        required: true

# Prometheus Metrics Exporter
metrics:
  __metadata:
    label: "Prometheus metrics"
    description: "Prometheus Metrics Configurations"
  enabled:
    __metadata:
      label: "Mongodb exporter Docker image Tag"
      description: "Enables Metrics for this deployment. Defaults to false."
      type: "boolean"
      required: true
  image:
    name:
      __metadata: 
        label: "Mongodb exporter Docker image name"
        description: "Docker image name to be pulled for MongoDB Metrics Exporter"
        type: "string"
        required: false
    tag: 
      __metadata: 
        label: "Image tag"
        description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
        type: "string"
        required: false
  port:
    __metadata:
      label: "MongoDB metrics exporter port"
      description: "Defaults 9216. Input a number from 1001 to 65535."
      type: "number"
      required: false
  path:
    __metadata: 
      label: "Path"
      description: "Path for Export MongoDB Metrics. Defaults to '/metrics'"
      type: "string"
      required: false
  socketTimeout: 
    __metadata: 
      label: "Socket timeout"
      description: "Defaults to '3s'. Input number followed by 's'."
      type: "string"
      required: false
  syncTimeout: 
    __metadata: 
      label: "Sync timeout"
      description: "Defaults to '1m'. Input number followed by 'm'."
      type: "string"
      required: false
  prometheusServiceDiscovery:
    __metadata:
      label: "Enable prometheus service discovery"
      description: "Defaults to true. Enables Prometheus to discover MongoDB's metrics"
      type: "boolean"
      required: true
  resources:
    requests:
      cpu: 
        __metadata: 
          label: "CPU request"
          description: "The minimum required CPU core. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
          type: "string"
          required: false   
      memory: 
        __metadata: 
          label: "Memory request"
          description: "The minimum memory in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: false  
    limits:
      cpu: 
        __metadata: 
          label: "CPU limit"
          description: "The upper limit of CPU core. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
          type: "string"
          required: false  
      memory: 
        __metadata: 
          label: "Memory limit"
          description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: false

global:
  __metadata:
    label: "Global image secret name"
    name: "Global Image Secret Name"
    description: "A secret that is used globally in the chart"
  image:
    repository:
      __metadata:
        name: "repository"
        label: "Global image repository"
        description: "Docker registry to pull all the images from."
        type: "string"
        immutable: false
        required: true
    pullSecret:
      __metadata:
        name: "pullSecret"
        label: "Global image pull secret"
        description: "Image pull secret to be used globally for all images"
        type: "string"
        immutable: false
        required: false
    pullPolicy:
      __metadata:
        name: "pullPolicy"
        label: "Global image pull policy"
        description: "Always, Never, or IfNotPresent. Defaults to IfNotPresent"
        type: "string"
        immutable: false
        required: true
        options:
        - label: "IfNotPresent"
          value: "IfNotPresent"
        - label: "Always"
          value: "Always"
        - label: "Never"
          value: "Never"
  sch:
    enabled:
      __metadata:
        name: "sch subchart"
        label: "ibm-sch subchart is used"
        description: "Set to false only is upstream chart provides ibm-sch chart"
        type: "boolean"
        hidden: false

keep:
  __metadata:
    label: "Do not remove mongodb on helm delete."
    description: "If enabled helm delete will preserve mongodb running in kubernetes. Defaults to false."
    type: "boolean"
    required: false

resources:
  __metadata:
    label: "Resource quotas"
    description: "MongoDB Container Resources Configurations"
  requests:
    cpu: 
      __metadata: 
        label: "CPU request"
        description: "The minimum required CPU core. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: false   
    memory: 
      __metadata: 
        label: "Memory request"
        description: "The minimum memory in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: false  
  limits:
    cpu: 
      __metadata: 
        label: "CPU limit"
        description: "The upper limit of CPU core. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: false  
    memory: 
      __metadata: 
        label: "Memory limit"
        description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: false

persistentVolume:
  __metadata:
    label: "Persistence configuration"
    description: "Persistent Volume Configuration for mongodb server pods"
  enabled: 
    __metadata:
      label: "Enable persistence storage for the mongodb server"
      description: "Select this checkbox to store mongodb server data on a persistent volume so that the data is preserved if the pod is stopped."
      type: "boolean"
      required: true
  useDynamicProvisioning: 
    __metadata:
      label: "Use dynamic provisioning"
      description: "Select this checkbox to allow the cluster to automatically provision new storage resource and create PersistentVolume objects."
      type: "boolean"
      required: true
  size: 
    __metadata:
      label: "Size of the volume claim"
      description: "Defaults to 10Gi of storage request. Choose a different size of disk if needed."
      type: "string"
      required: true
  accessModes:
    __metadata:
      label: "Access mode"
      description: "Defaults to ReadWriteOnce. Access Mode of the PV."
      required: false
      options:
        - label: "ReadWriteOnce"
          value: "ReadWriteOnce"
        - label: "ReadOnlyMany"
          value: "ReadOnlyMany"
        - label: "ReadWriteMany"
          value: "ReadWriteMany"
  storageClass:
    __metadata:
      label: "Storageclass"
      description: "Defaults to null. Storage Class used to provision PV."
      required: false
      query:
        provider: kubernetes
        resource: storageclasses
        filter: ".metadata.uid"
  selector:
    label:
      __metadata:
        label: "Label to be used during pvc bind"
        description: "Label for persistent volume claim selectors to control how pvc's bind/reserve storage. Defaults application specific"
        type: "string"
        required: false
    value:
      __metadata:
        label: "Value for the selector.label"
        description: "Value for persistent volume claim selectors to control how pvc's bind/reserve storage. Defaults application specific"
        type: "string"
        required: false
  annotations:
    __metadata:
      label: "Annotations to the PV"
      description: "provide annotation to the persistent volument, by default it is empty."
      type: "string"
      required: false

auth:
  __metadata:
    label: "Authentication and authorization"
    description: "Authentication and Authorization Configurations for Release"
  enabled: 
    __metadata:
      label: "Enable authentication & authorization"
      description: "Enables authentication & authorization for this deployment. Defaults to true."
      type: "boolean"
      required: true
  authSecretName:
    __metadata:
      label: "Existing kube secret Name for mongodb admin User"
      description: "Will be generated if not provided. Name of your existing Keyfile Secret. The secret must contain 'user' and 'password'."
      required: false
      query:
        provider: kubernetes
        resource: secrets
        filter: ".metadata.uid"
  keySecretName:
    __metadata:
      label: "Existing kube secret Name for mongodb keyfile"
      description: "Will be generated if not provided. Name of your existing Keyfile Secret. The secret must contain 'key.txt'."
      required: false
      query:
        provider: kubernetes
        resource: secrets
        filter: ".metadata.uid"  
  metricsSecretName:
    __metadata:
      label: "Existing kube secret name for metrics auth"
      description: "Will be generated if not provided. Only needed when Metrics is enabled. The secret must contain 'user' and 'password'."
      required: false
      query:
        provider: kubernetes
        resource: secrets
        filter: ".metadata.uid"

rbac:
  __metadata:
    label: "Automatic RBAC configuration"
    description: "Configure RBAC required for generate secrets"
  create: 
    __metadata:
      label: "Enable chart to create role and binding"
      description: "Enables chart to create its own role and binding. Defaults to true."
      type: "boolean"
      required: true

serviceAccount:
  __metadata:
    label: "Serviceaccount configuration"
    description: "Configure ServiceAccount used by the chart"
  create: 
    __metadata:
      label: "Enable chart to create serviceAccount."
      description: "Enables chart to create its own serviceaccount. Defaults to true."
      type: "boolean"
      required: true
  name:
    __metadata:
      label: "Name of the serviceaccount"
      description: "Name of the service account to use (and create if specified). The serviceaccount must has the permission to create and delete Secrets."
      required: false
      type: "string"

tls:
  __metadata:
    label: "TLS encryption"
    description: "TLS Encryption Configurations"
  enabled: 
    __metadata:
      label: "Enable mongodb TLS encryption"
      description: "Enables TLS for this deployment. Defaults to true."
      type: "boolean"
      required: true
  tlsSecretName:
    __metadata:
      label: "Will be generated if not provided. Existing Kube TLS Secret Name for CA used by MongoDB"
      description: "Name of your existing Kube TLS Secret for CA. If Auth is enabled, you must specify predefined Kube Secret Name for Production Deployment."
      required: false
      query:
        provider: kubernetes
        resource: secrets
        filter: ".metadata.uid"

wiredTigerCacheSizeGb:
  __metadata:
    label: "Mongodb wiredtiger engine cache Size in GB (float)"
    description: "WiredTiger cache. Recommand to change it upto 0.4 of Container Mem Limit. Defaults 0.256 (256MB)."
    type: "number"
    required: true

oplogSizeMB:
  __metadata:
    label: "Mongodb replica set oplog size in MB (integer)"
    description: "The oplog keeps record of all operations that modify the data. Set the maximum size in operation log (990 MB to 50 GB). Defaults 1000MB."
    type: "number"
    required: true

configmap:
  __metadata: 
    label: "Mongodb configuration file"
    description: "Defaults to empty. JSON Format. Configuration File for mongod process. Refer to Documentation."
    type: "string"
    min: 10
    max: 20
    multiline: true
    required: false

securityContext:
  __metadata:
    label: "Securitycontext configuration"
    description: "Security context configuration for all containers and pods"
  mongodb:
    runAsUser: 
      __metadata:
        label: "Runasuser"
        description: "Run as user config for the contianers mongodb, mongodb install, mongodb config copy, mongodb exporter, bats"
        type: "number"
        required: false
    runAsGroup:      
      __metadata:
        label: "Runasgroup"
        description: "Run as group config for the contianers mongodb, mongodb install, mongodb config copy, mongodb exporter, bats"
        type: "number"
        required: false
    fsGroup: 
      __metadata:
        label: "Fsgroup"
        description: "Fsgroup config for the contianers mongodb, mongodb install, mongodb config copy, mongodb exporter, bats"
        type: "number"
        required: false
  creds:
    runAsUser:       
      __metadata:
        label: "Runasuser"
        description: "Run as user config for the containers creds gen and creds clean up"
        type: "number"
        required: false

podAnnotations: 
  __metadata:
    label: "Annotations for pod"
    description: "Annotations to be added to MongoDB pods. JSON Format."
    type: "string"
    required: false

nodeSelector: 
  __metadata:
    label: "Node selector"
    description: provide node selector details"
    type: "string"
    required: false

affinity: 
  __metadata:
    label: "Affinity"
    description: "JSON Format."
    type: "string"
    required: false

affinityMongodb: 
  __metadata:
    label: "Affinity for mongo statefulset"
    description: "Affinity settings influencing only MongoDb statefulset. JSON Format."
    type: "string"
    required: false

tolerations: 
  __metadata:
    label: "Tolerations"
    description: "JSON Array Format."
    type: "string"
    required: false

extraLabels:
  __metadata:
    label: "Extra labels"
    description: "JSON Format."
    type: "string"
    required: false

podDisruptionBudget:
  __metadata:
    label: "Pod disruption budget"
    description: "provide pod disruption budget"
    type: "string"
    required: false

serviceAnnotations: 
  __metadata:
    label: "Service annotations"
    description: "Annotations to be added to the service. JSON Format."
    type: "string"
    required: false

extraVars:
  __metadata:
    label: "Environment variables"
    description: "Additional environment variables to be set in the container. JSON Format."
    type: "string"
    required: false

readinessProbe:
  __metadata:
    label: "Readinessprobe configuration"
    description: "Readiness probe config for Mongodb Servers"
  initialDelaySeconds:
    __metadata:
      label: "Initial delay seconds"
      description: "Number of seconds after the container has started before the probe is initiated."
      type: "number"
      required: false
  timeoutSeconds:
    __metadata:
      label: "Timeout seconds"
      description: "Number of seconds after which the probe times out."
      type: "number"
      required: false
  failureThreshold:
    __metadata:
      label: "Failure threshold"
      description: "Number of failures to accept before giving up and restarting the."
      type: "number"
      required: false
  periodSeconds:
    __metadata:
      label: "Period seconds"
      description: "How often (in seconds) to perform the probe."
      type: "number"
      required: false
  successThreshold:
    __metadata:
      label: "Success threshold"
      description: "Success Threshold."
      type: "number"
      required: false

livenessProbe:
  __metadata:
    label: "Liveness probe configuration"
    description: "Liveness probe config for Mongodb Servers"
  initialDelaySeconds:
    __metadata:
      label: "Initial delay seconds"
      description: "Number of seconds after the container has started before the probe is initiated."
      type: "number"
      required: false
  timeoutSeconds:
    __metadata:
      label: "Timeout seconds"
      description: "Number of seconds after which the probe times out."
      type: "number"
      required: false
  failureThreshold:
    __metadata:
      label: "Failure threshold"
      description: "Number of failures to accept before giving up and marking the pod as Unready."
      type: "number"
      required: false
  periodSeconds:
    __metadata:
      label: "Period seconds"
      description: "How often (in seconds) to perform the probe."
      type: "number"
      required: false
  successThreshold:
    __metadata:
      label: "Success threshold"
      description: "Success Threshold."
      type: "number"
      required: false

metering:
  __metadata:
    label: "Metering details"
    description: "Annotations to be used metering service (if present)."
    hidden: true
    type: "string"
    multiline: true
    required: false

clusterDomain:
  __metadata:
    name: "clusterDomain"
    label: "Cluster domain used by in-cluster KubeDNS names."
    description: "Specify only if your KubeDNS service names does not end with cluster.local."
    type: "string"
    required: false
    hidden: true
