###############################################################################
# Licensed Materials - Property of IBM.
# Copyright IBM Corporation 2018. All Rights Reserved.
# U.S. Government Users Restricted Rights - Use, duplication or disclosure
# restricted by GSA ADP Schedule Contract with IBM Corp.
#
# Contributors:
# IBM Corporation - initial API and implementation
###############################################################################

###############################################################################
# Default values for ibm-mobilefirst-foundation-analytics
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
###############################################################################

###############################################################################
## Architecture configuration metadata
###############################################################################
arch:
  __metadata:
    label: "Architecture scheduling preferences"
    description: "Architecture preference for target worker node."
  amd64:
    __metadata:
      name: "amd64"
      label: "AMD64 scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"
  ppc64le:
    __metadata:
      name: "ppc64le"
      label: "PPC64LE scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"
  s390x:
    __metadata:
      name: "s390x"
      label: "S390X scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
value: "3 - Most preferred"


###############################################################################
## Common image variables
###############################################################################
image:
  repository:
    __metadata:
      label: "Mobile Foundation Analytics image Repository"
      description: "Docker registry to pull Mobile Foundation Analytics image from"
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      label: "Image tag"
      description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Image pull policy"
      description: "The default pull policy is IfNotPresent which causes the Kubelet to skip pulling an image if it already exists."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
      - label: "IfNotPresent"
        value: "IfNotPresent"
  __metadata:
    label: "Image"
    description: "Stored instance of a container that holds a set of software needed to run an application."

###############################################################################
## Scaling
###############################################################################
scaling:
  __metadata:
    label: "Scaling"
    description: "Number of replicas"
  replicaCount:
    __metadata:
      label: "Replica Count"
      description: "Number of Pods requested"
      type: "number"
      immutable: false
      required: true

###############################################################################
## MobileFirst Operational Analytics Console Credentials
###############################################################################
mobileFirstAnalyticsConsole:
  __metadata:
    label: "Mobile Foundation Operational Analytics Credentials"
    description: "Provide credential to connect to Mobile Foundation Operational Analytics Console"
  user:
    __metadata:
      label: "Username"
      description: "Administrator Username"
      type: "string"
      immutable: false
      required: true
  password:
    __metadata:
      label: "Password"
      description: "Administrator Password"
      type: "password"
      immutable: false
      required: true

###############################################################################
## MobileFirst Operational Analytics specific details
###############################################################################
analyticsConfiguration:
  __metadata:
    label: "MobileFirst Operational Analytics Configurations"
    description: "Provide the appropriate values for Operational Analytics Service Configuration settings"
  clusterName:
    __metadata:
      label: "Cluster Name"
      description: "Name of the MobileFirst Operational Analytics Cluster"
      type: "string"
      immutable: false
      required: true
  numberOfShards:
    __metadata:
      label: "Number of Shards"
      description: "Number of Elasticsearch shards to be set for the Cluster"
      type: "string"
      immutable: false
      required: true
  replicasPerShard:
    __metadata:
      label: "Replicas per Shard"
      description: "Number of Replicas per Shard for the Cluster"
      type: "string"
      immutable: false
      required: true
  analyticsDataDirectory:
    __metadata:
      label: "Data Directory"
      description: "Name of the directory where Analytics Data should be stored"
      type: "string"
      immutable: false
      required: true

###############################################################################
## Persistence Storage
###############################################################################
## Persistence options
persistence:
  __metadata:
    label: "Persistence configuration"
    description: "Enables persistence for this deployment."
  enabled:
   __metadata:
      name: "enabled"
      label: "Enable persistence storage for the Mobile Foundation Operational Analytics"
      description: "On enabling persistent storage, the Operational Analytics data is preserved if the pod is stopped."
      type: "boolean"
      immutable: false
      required: true
  useDynamicProvisioning:
   __metadata:
      name: "useDynamicProvisioning"
      label: "Use dynamic provisioning"
      description: "Select this checkbox to allow the cluster to automatically provision new storage resource and create PersistentVolume objects. Defaults to false"
      type: "boolean"
      immutable: false
      required: true

## Data volume claim options
dataVolume:
  __metadata:
    label: "Data volume configuration"
    description: "Persistent volume claim for Analytics data storage"
  name:
    __metadata:
      name: "data-stor"
      label: "Name of the persistent volume claim"
      description: "By default a persistent volume claim will be created with this name."
      type: "string"
      immutable: false
      required: false
  existingClaimName:
    __metadata:
      name: "existingClaimName"
      label: "Existing volume claim"
      description: "By default a new persistent volume claim will be created. Specify an existing claim here if one is available."
      type: "string"
      immutable: false
      required: false
  storageClassName:
    __metadata:
      name: "storageClassName"
      label: "Existing storage class name"
      description: "Choose a specific storage class name. Defaults to the default storage class in the cluster."
      type: "string"
      immutable: false
      required: false
  size:
    __metadata:
      name: "size"
      label: "Size of the volume claim"
      description: "Defaults to 20Gi of storage request. Choose a different size of disk if needed."
      type: "string"
      immutable: false
      required: true

###############################################################################
## MobileFirst JNDI Configurations
###############################################################################
keystores:
  __metadata:
    label: "Override default Keystores (Optional)"
    description: "Provide the kubernetes secret. This secret has to be generated separately and kept ready"
  keystoresSecretName:
    __metadata:
      label: "Keystores Secret Name"
      description: "Name of the existing secret where the keystore and truststore, and their passwords are avaiable. View the readme to create the secret."
      type: "string"
      immutable: false
      required: false

jndiConfigurations:
  __metadata:
    label: "JNDI Configurations (Optional)"
    description: "Set up JNDI properties for MobileFirst Server web applications"
  mfpfProperties:
    __metadata:
      label: "JNDI Configuration"
      description: "Provide MobileFirst specific JNDI configuration as comma separated name=value pairs."
      type: "string"
      required: false

###############################################################################
## Ingress
###############################################################################
ingress:
  __metadata:
    label: "Ingress settings"
    description: "Ingress settings for Mobile Foundation Analytics"
  enabled:
    __metadata:
      label: "Enable ingress"
      description: "Specifies whether to use Ingress."
      type: "boolean"
      required: true
  hostname:
    __metadata:
      label: "Hostname of the Endpoint to be configured"
      description: "The hostname of the Endpoint that has to be configured in the ingress definition"
      type: "string"
      required: false
  tlsEnabled:
    __metadata:
      label: "Enable SSL/TLS"
      description: "Specifies whether to enable TLS on the Ingress endpoint."
      type: "boolean"
      required: false
  sslPassThrough:
    __metadata:
      label: "Enable SSL passthrough"
      description: "Specifies is the SSL request should be passed through to the MobileFirst service - SSL termination occurs in the MobileFirst service."
      type: "boolean"
      required: false
  tlsSecretName:
    __metadata:
      label: "TLS secret name"
      description: "The secret has to be pre-created using the relevant certificate and key. Mandatory if SSL/TLS is enabled."
      type: "string"
      required: false

###############################################################################
## Resource constraints
###############################################################################
resources:
  __metadata:
    label: "Resource quotas"
    description: "Configure resource constraints"
  requests:
    cpu:
      __metadata:
        label: "CPU request"
        description: "The minimum required CPU core. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true
    memory:
      __metadata:
        label: "Memory request"
        description: "The minimum memory in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: true
  limits:
    cpu:
      __metadata:
        label: "CPU limit"
        description: "The upper limit of CPU core. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true
    memory:
      __metadata:
        label: "Memory limit"
        description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki. "
        type: "string"
        required: true

###############################################################################
## Logs
###############################################################################
logs:
  __metadata:
    label: "Logs"
    description: "Logs Configuration"
  consoleFormat:      
    __metadata:
      name: "consoleFormat"
      label: "Console logging format"
      description: "Specifies container log output format."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "json"
        value: "json"
      - label: "basic"
        value: "basic"
  consoleLogLevel:      
    __metadata:
      name: "consoleLogLevel"
      label: "Console logging level"
      description: "Controls the granularity of messages that go to the container log."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "info"
        value: "info"
      - label: "audit"
        value: "audit"
      - label: "fatal"
        value: "fatal"
      - label: "debug"
        value: "debug"
      - label: "warning"
        value: "warning"
      - label: "error"
        value: "error"
      - label: "off"
        value: "off"
  consoleSource:      
    __metadata:
      name: "consoleSource"
      label: "Console logging sources"
      description: "Specify sources that are written to the container log. Use a comma separated list for multiple sources."
      type: "string"
      immutable: false
      required: true
