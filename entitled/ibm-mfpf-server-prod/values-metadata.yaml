###############################################################################
# Licensed Materials - Property of IBM.
# Copyright IBM Corporation 2018. All Rights Reserved.
# U.S. Government Users Restricted Rights - Use, duplication or disclosure
# restricted by GSA ADP Schedule Contract with IBM Corp.
#
# Contributors:
# IBM Corporation - initial API and implementation
###############################################################################

###############################################################################
# Default values for ibm-mobilefirst-foundation-server
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
###############################################################################

###############################################################################
## Architecture configuration metadata
###############################################################################
arch:
  __metadata:
    label: "Architecture scheduling preferences"
    description: "Architecture preference for target worker node."
  amd64:
    __metadata:
      name: "amd64"
      label: "AMD64 scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"
  ppc64le:
    __metadata:
      name: "ppc64le"
      label: "PPC64LE scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"
  s390x:
    __metadata:
      name: "s390x"
      label: "S390X scheduling preference"
      description: "Architecture preference for target worker node."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
value: "3 - Most preferred"


###############################################################################
## Common image variables
###############################################################################
image:
  repository:
    __metadata:
      label: "Mobile Foundation Server image Repository"
      description: "Docker registry to pull Mobile Foundation Server image from"
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      label: "Image tag"
      description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Image pull policy"
      description: "The default pull policy is IfNotPresent which causes the Kubelet to skip pulling an image if it already exists."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
      - label: "IfNotPresent"
        value: "IfNotPresent"
  __metadata:
    label: "Image"
    description: "Stored instance of a container that holds a set of software needed to run an application."

###############################################################################
## Scaling
###############################################################################
scaling:
  __metadata:
    label: "Scaling"
    description: "Number of replicas"
  replicaCount:
    __metadata:
      label: "Replica Count"
      description: "Number of Pods requested"
      type: "number"
      immutable: false
      required: true

###############################################################################
## MobileFirst Operations Console Credentials
###############################################################################
mobileFirstOperationsConsole:
  __metadata:
    label: "MobileFirst Operations Console Credentials"
    description: "Provide credential to connect to MobileFirst Operations Console"
  user:
    __metadata:
      label: "Username"
      description: "Administrator Username"
      type: "string"
      immutable: false
      required: true
  password:
    __metadata:
      label: "Password"
      description: "Administrator Password"
      type: "password"
      immutable: false
      required: true

###############################################################################
## Existing DB database details for the MobileFirst database
###############################################################################
existingDB2Details:
  __metadata:
    label: "Existing DB database details for the MobileFirst database"
    description: "Specify existing database details for Mobile Foundation Server to connect."
  db2Host:
    __metadata:
      label: "Hostname"
      description: "DB Hostname/IP for MFP to connect"
      type: "string"
      immutable: false
      required: true
  db2Port:
    __metadata:
      label: "Port"
      description: "DB Port number for MFP to connect"
      type: "string"
      immutable: false
      required: true
  db2Username:
    __metadata:
      label: "Username"
      description: "Username to be used to connecto to DB"
      type: "string"
      immutable: false
      required: true
  db2Password:
    __metadata:
      label: "Password"
      description: "Password for the DB user"
      type: "password"
      immutable: false
      required: true
  db2Database:
    __metadata:
      label: "Database"
      description: "Existing DB Database name for MFP to connect to."
      type: "string"
      immutable: false
      required: true
  db2Schema:
    __metadata:
      label: "Schema Name"
      description: "DB Schema Name to be created when the MobileFirst server is created. If the Schema already exists, it will be reused"
      type: "string"
      immutable: false
      required: true
  db2ConnectionIsSSL:
    __metadata:
      label: "Connect to DB over ssl port"
      description: "Whether or not the DB Connection should be made over SSL. Specify if the port number is an SSL port or not"
      type: "boolean"
      immutable: false
      required: true

###############################################################################
## Existing MobileFirst Operational Analytics 
###############################################################################
existingMobileFirstAnalytics:
  __metadata:
    label: "Connect to existing MobileFirst Operational Analytics (Optional)"
    description: "Specify analytics endpoint and credentials to connect to MobileFirst Operational Analytics"
  analyticsEndpoint:
    __metadata:
      label: "Analytics Endpoint"
      description: "The URL where MobileFirst Operational Analytics is deployed. Provide in the following format: http://ANALYTICS_NODE_HOST:ANALYTICS_NODE_PORT"
      type: "string"
      immutable: false
      required: false
  analyticsAdminUser:
    __metadata:
      label: "Username"
      description: "Username for the MobileFirst Operational Analytics instance."
      type: "string"
      immutable: false
      required: false
  analyticsAdminPassword:
    __metadata:
      label: "Password"
      description: "Password for the MobileFirst Operational Analytics instance."
      type: "password"
      immutable: false
      required: false

###############################################################################
## MobileFirst Server specific details
###############################################################################
keystores:
  __metadata:
    label: "Override default Keystores (Optional)"
    description: "Use your custom generated secret to override default Keystores"
  keystoresSecretName:
    __metadata:
      label: "Keystores Secret Name"
      description: "Name of the existing secret where the keystore and truststore, and their passwords are avaiable. View the readme to create the secret."
      type: "string"
      immutable: false
      required: false
  
jndiConfigurations:
  __metadata:
    label: "JNDI Configurations (Optional)"
    description: "Set up JNDI properties for MobileFirst Server web applications"
  mfpfProperties:
    __metadata:
      label: "JNDI Configuration"
      description: "Provide MobileFirst specific JNDI configuration as comma separated name=value pairs."
      type: "string"
      required: false

###############################################################################
## Ingress
###############################################################################
ingress:
  __metadata:
    label: "Ingress settings"
    description: "Ingress settings for Mobile Foundation Server"
  enabled:
    __metadata:
      label: "Enable ingress"
      description: "Specifies whether to use Ingress."
      type: "boolean"
      required: true
  hostname:
    __metadata:
      label: "Hostname of the Endpoint to be configured"
      description: "The hostname of the Endpoint that has to be configured in the ingress definition"
      type: "string"
      required: false
  tlsEnabled:
    __metadata:
      label: "Enable SSL/TLS"
      description: "Specifies whether to enable TLS on the Ingress endpoint."
      type: "boolean"
      required: false
  sslPassThrough:
    __metadata:
      label: "Enable SSL passthrough"
      description: "Specifies is the SSL request should be passed through to the MobileFirst service - SSL termination occurs in the MobileFirst service."
      type: "boolean"
      required: false
  tlsSecretName:
    __metadata:
      label: "TLS secret name"
      description: "The secret has to be pre-created using the relevant certificate and key. Mandatory if SSL/TLS is enabled."
      type: "string"
      required: false

###############################################################################
## Resource constraints
###############################################################################
resources:
  __metadata:
    label: "Resource quotas"
    description: "Configure resource constraints"
  requests:
    cpu:
      __metadata: 
        label: "CPU request"
        description: "The minimum required CPU core. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true 
    memory:
      __metadata: 
        label: "Memory request"
        description: "The minimum memory in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
        type: "string"
        required: true 
  limits:
    cpu:
      __metadata: 
        label: "CPU limit"
        description: "The upper limit of CPU core. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
        type: "string"
        required: true 
    memory:
      __metadata: 
        label: "Memory limit"
        description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki. "
        type: "string"
        required: true 

###############################################################################
## Logs
###############################################################################
logs:
  __metadata:
    label: "Logs"
    description: "Logs Configuration"
  consoleFormat:      
    __metadata:
      name: "consoleFormat"
      label: "Console logging format"
      description: "Specifies container log output format."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "json"
        value: "json"
      - label: "basic"
        value: "basic"
  consoleLogLevel:      
    __metadata:
      name: "consoleLogLevel"
      label: "Console logging level"
      description: "Controls the granularity of messages that go to the container log."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "info"
        value: "info"
      - label: "audit"
        value: "audit"
      - label: "fatal"
        value: "fatal"
      - label: "debug"
        value: "debug"
      - label: "warning"
        value: "warning"
      - label: "error"
        value: "error"
      - label: "off"
        value: "off"
  consoleSource:      
    __metadata:
      name: "consoleSource"
      label: "Console logging sources"
      description: "Specify sources that are written to the container log. Use a comma separated list for multiple sources."
      type: "string"
      immutable: false
      required: true
