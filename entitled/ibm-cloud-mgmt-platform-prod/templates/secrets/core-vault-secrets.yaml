# We need to have the isIcp flag enabled only for the PPA delivery for rest all the
# secrets needs to be created. The one to skip in PPA is docker registry entry
{{- template "isIcp" . -}}
{{- if not (.Values.isIcp) }}
{{- /*
    vault-hcl.tpl config file is dynamically generated by substituting in
    the CouchDB creds, and then base64 encoding the entire thing into a Secret
*/ -}}
# Vault config file
apiVersion: v1
kind: Secret
metadata:
  name: core-vault
  labels:
{{ include "core.labels" .  | indent 4 }}
type: Opaque
data:
  vault.hcl: {{ tpl (.Files.Get "config/vault-hcl.tpl") . | b64enc }}
{{ end }}
