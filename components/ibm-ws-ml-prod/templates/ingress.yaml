{{- if .Values.ingress.enabled }}
apiVersion: extensions/v1
kind: Ingress
metadata:
  name: {{ .Values.ingress.name }}
  annotations:
    ingress.kubernetes.io/secure-backends: "true"
    ingress.kubernetes.io/proxy-body-size: 1024m
{{- if and ($.Values.global.annotations) (eq $.Values.microservice.deployment.env "icp4d") }}
{{ toYaml $.Values.global.annotations | trim | indent 6 }}
{{- end }}
spec:
{{- if .Values.ingress.tls.enabled }}  
  tls:
    - secretName: {{ .Values.ingress.tls.secret }}
      hosts:
        - {{ .Values.ingress.host }}
{{- end }}
  rules:
{{- if .Values.ingress.host }}  
  - host: {{ .Values.ingress.host }}
    http:
{{- else }}
    http:
{{- end }}
      paths:
      - backend:
          serviceName: portal-main
          servicePort: 443
        path: /
      - backend:
          serviceName: node-icp4d
          servicePort: 80
        path: /node-test
      - backend:
          serviceName: ngp-projects-api
          servicePort: 443
        path: /v2/projects
      - backend:
          serviceName: portal-common-api
          servicePort: 443
        path: /v2/user_profiles
      - backend:
          serviceName: portal-notifications
          servicePort: 443
        path: /v1/notifications
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/catalogs
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/assets
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/asset_types
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/data_assets
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/folder_assets
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/trashed_assets
      - backend:
          serviceName: dc-main
          servicePort: 443
        path: /catalog
      - backend:
          serviceName: portal-catalog
          servicePort: 443
        path: /data/catalogs
      - backend:
          serviceName: wdp-connect-connection
          servicePort: 443
        path: /v2/connections
      - backend:
          serviceName: wdp-connect-connection
          servicePort: 443
        path: /v2/datasource_types
      - backend:
          serviceName: wdp-connect-connector
          servicePort: 443
        path: /v2/connectors
      - backend:
          serviceName: metadata-discovery
          servicePort: 443
        path: /v2/data_discoveries
      - backend:
          serviceName: wdp-activities
          servicePort: 443
        path: /v2/activities
      - backend:
          serviceName: wdp-activities
          servicePort: 443
        path: /v2/data_flows
      - backend:
          serviceName: wdp-profiling
          servicePort: 443
        path: /v2/data_profiles
      - backend:
          serviceName: wdp-profiling
          servicePort: 443
        path: /v2/data_classes
      - backend:
          serviceName: wdp-sampling
          servicePort: 443
        path: /v2/data_samples
      - backend:
          serviceName: dataconn-engine-opdiscovery
          servicePort: 443
        path: /v2/dataconn/discovery
      - backend:
          serviceName: wdp-interactive-engine-service
          servicePort: 443
        path: /v2/dataconn/interactive
      - backend:
          serviceName: dataconn-engine-service
          servicePort: 443
        path: /v2/dataconn/engine
      - backend:
          serviceName: wdp-scheduling
          servicePort: 443
        path: /v2/schedules
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policies
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policy_categories
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policy_taxonomies
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/governance_types
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policy_metrics
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policy_rules
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/governed_items
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policy_audit_records
      - backend:
          serviceName: wdp-business-glossary
          servicePort: 443
        path: /v2/glossary_categories
      - backend:
          serviceName: wdp-business-glossary
          servicePort: 443
        path: /v2/glossary_sets
      - backend:
          serviceName: wdp-business-glossary
          servicePort: 443
        path: /v2/glossary_terms
      - backend:
          serviceName: wdp-business-glossary
          servicePort: 443
        path: /v2/glossary_imports
      - backend:
          serviceName: wdp-profiling-messaging
          servicePort: 443
        path: /v2/profiling_messaging
      - backend:
          serviceName: wdp-lineage
          servicePort: 443
        path: /v2/asset_lineages
      - backend:
          serviceName: wdp-lineage
          servicePort: 443
        path: /v2/lineage_events
      - backend:
          serviceName: wdp-monitoring
          servicePort: 443
        path: /v2/monitoring
      - backend:
          serviceName: wdp-profiling-ui
          servicePort: 443
        path: /profiles
      - backend:
          serviceName: wdp-search
          servicePort: 443
        path: /v2/search
      - backend:
          serviceName: portal-common-api
          servicePort: 443
        path: /v1/nav
      - backend:
          serviceName: portal-common-api
          servicePort: 443
        path: /v1/community_content
      - backend:
          serviceName: portal-common-api
          servicePort: 443
        path: /v1/accounts
      - backend:
          serviceName: portal-common-api
          servicePort: 443
        path: /v2/entitlements
      - backend:
          serviceName: portal-common-api
          servicePort: 443
        path: /v2/nav
      - backend:
          serviceName: catalog-api
          servicePort: 443
        path: /v2/cams
      - backend:
          serviceName: tenants-api
          servicePort: 443
        path: /v1/tenants
      - backend:
          serviceName: notebooks-api
          servicePort: 443
        path: /v1/notebooks
      - backend:
          serviceName: notebooks-job-manager
          servicePort: 443
        path: /v1/notebook_executions
      - backend:
          serviceName: wdp-notebooks-api
          servicePort: 443
        path: /v2/notebooks
      - backend:
          serviceName: environments-api
          servicePort: 443
        path: /v2/environments
      - backend:
          serviceName: environments-api
          servicePort: 443
        path: /v2/runtimes
      - backend:
          serviceName: notebooks-job-manager
          servicePort: 443
        path: /v2/notebook_executions
      - backend:
          serviceName: watson-studio-usage-api
          servicePort: 443
        path: /v2/total_usage
      - backend:
          serviceName: portal-data
          servicePort: 443
        path: /data
      - backend:
          serviceName: portal-data
          servicePort: 443
        path: /data/common
      - backend:
          serviceName: wdp-policy-ui
          servicePort: 443
        path: /gov
      - backend:
          serviceName: dap-notebooks-ui
          servicePort: 443
        path: /analytics/notebooks
      - backend:
          serviceName: ax-proxy
          servicePort: 443
        path: /data/notebooks/converter
      - backend:
          serviceName: ax-proxy
          servicePort: 443
        path: /data/jupyter
      - backend:
          serviceName: ax-proxy
          servicePort: 443
        path: /data/jupyter2
      - backend:
          serviceName: environments-ui
          servicePort: 443
        path: /environments
      - backend:
          serviceName: wdp-transform-service
          servicePort: 443
        path: /v2/transform
      - backend:
          serviceName: asset-files-api
          servicePort: 443
        path: /v2/asset_files
      - backend:
          serviceName: wdp-policy-service
          servicePort: 443
        path: /v2/policy_terms
      - backend:
          serviceName: environments-api
          servicePort: 443
        path: /v2/runtime_definitions
      - backend:
          serviceName: streaming-pipelines-sample-data
          servicePort: 443
        path: /v2/streams_flows/sample_generator
      - backend:
          serviceName: streaming-pipelines-python-validator
          servicePort: 443
        path: /v2/streams_flows/python_validator
      - backend:
          serviceName: streaming-pipelines-api
          servicePort: 443
        path: /v2/streams_flows
      - backend:
          serviceName: streaming-pipelines-api
          servicePort: 443
        path: /v2/streaming_pipelines
      - backend:
          serviceName: streaming-pipelines-ui
          servicePort: 443
        path: /streams
{{- end }}