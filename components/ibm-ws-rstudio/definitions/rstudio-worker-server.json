{
  "displayName": "RStudio with R 3.6",
  "description": "RStudio Server 1.2 with R 3.6",
  "annotations": [
      {
        "name": "cloudpakName",
        "value": "{{ .Values.global.annotations.cloudpakName }}"
      },
      {
        "name": "cloudpakId",
        "value": "{{ .Values.global.annotations.cloudpakId }}"
      },
      {
        "name": "cloudpakVersion",
        "value": "{{ .Values.global.annotations.cloudpakVersion }}"
      },
      {
        "name": "productMetric",
        "value": "{{ .Values.global.annotations.productMetric }}"
      },
      {
        "name": "productChargedContainers",
        "value": "{{ .Values.global.annotations.productChargedContainers }}"
      },
      {
        "name": "productID",
        "value": "{{ .Values.global.annotations.productID }}"
      },
      {
        "name": "productName",
        "value": "{{ .Values.global.annotations.productName }}"
      },
      {
        "name": "productVersion",
        "value": "{{ .Values.global.annotations.productVersion }}"
      }
  ],
  "author": "IBM",
  "tested": true,
  "isService": false,
  "runtimeType": "rstudio-worker",
  "features": ["worker"],
  "portMappings": [
    {
      "servicePort": 8443,
      "containerPort": 8443,
      "protocol": "TCP"
    },
    {
      "servicePort": 3838,
      "containerPort": 3838,
      "protocol": "TCP"
    }
  ],
  "replicas": 1,
  "image": "{{ .Values.global.dockerRegistryPrefix }}/{{ .Values.rstudioServer.image.name }}:{{ .Values.rstudioServer.image.tag }}",
  "command": ["/scripts/startup.sh"],
  "volumes": [
    {
      "volume": "cchome-dbdrivers",
      "mountPath": "/cc-home/_global_/dbdrivers",
      "claimName": "cc-home-pvc-pvc",
      "subPath": "_global_/dbdrivers",
      "readOnly": true
    },
    {
      "volume": "cchome-R",
      "mountPath": "/cc-home/_global_/R",
      "claimName": "cc-home-pvc",
      "subPath": "_global_/R"
    },
    {
      "volume": "cchome-config-user-info",
      "mountPath": "/cc-home/_global_/config/user-info",
      "claimName": "cc-home-pvc",
      "subPath": "_global_/config/user-info",
      "readOnly": true
    },
    {
      "volume": "cchome-config-idleshutdown",
      "mountPath": "/cc-home/_global_/config/.idleshutdown",
      "claimName": "cc-home-pvc",
      "subPath": "_global_/config/.idleshutdown",
      "readOnly": true
    },
    {
      "volume": "cchome-customer-truststores",
      "mountPath": "/cc-home/_global_/security/customer-truststores",
      "claimName": "cc-home-pvc",
      "subPath": "_global_/security/customer-truststores",
      "readOnly": true
    },
    {
      "volume": "scripts",
      "mountPath": "/cc-home/.scripts",
      "claimName": "cc-home-pvc",
      "subPath": ".scripts",
      "readOnly": true          
    },
    {
      "volume": "project_dir",
      "mountPath": "/project_data/rstudio",
      "claimName": "file-api-claim",
      "subPath": "projects/$project_id/rstudio/$user_id"
    },
    {
      "volume": "project_dir",
      "mountPath": "/project_data/assets",
      "claimName": "file-api-claim",
      "subPath": "projects/$project_id/assets"
    }
  ],
  "probes": {
    "liveness": {
      "path": "/",
      "scheme": "http",
      "port": 8787,
      "initialDelaySeconds": 120,
      "timeoutSeconds": 10,
      "periodSeconds": 10
    },
    "readiness": {
      "path": "/",
      "scheme": "http",
      "port": 8787,
      "initialDelaySeconds": 15,
      "timeoutSeconds": 10,
      "periodSeconds": 10
    }
  },
  "resources": {
    "cpu": {
      "request": -1,
      "minimum": 2000
    },
    "gpu": {
      "request": -1,
      "minimum": 0
    },
    "memory": {
      "request": -1,
      "minimum": 5120
    },
    "duration": {
      "value": -1,
      "units": "unix"
    }
  }
}