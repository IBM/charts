{{- include "sch.config.init" (list . "ibm-wex-prod.sch.chart.config.values") -}}
{{- $compHdpWorkerName := .sch.chart.components.wex.hdp.worker.name }}
{{- $compHpdLabelComponent := .sch.chart.components.wex.hdp.label.component }}
{{- $compHpdLabelRunWorkerService := .sch.chart.components.wex.hdp.label.runWorkerService }}
{{- $compHpdLabelRunWorkerStatefulset := .sch.chart.components.wex.hdp.label.runWorkerStatefulset }}

apiVersion: v1
kind: Service
metadata:
  name: {{ include "sch.names.fullCompName" (list . $compHdpWorkerName ) }}
  labels:
    app: {{ template "{{ .Chart.Name }}.fullname" . }}
    chart: {{ .Chart.Name }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
    component: wex-hdp
    run: {{ $compHpdLabelRunWorkerService }}
spec:
  ports:
  - name: yarn1
    port: 8030
    targetPort: 8030
    protocol: TCP
  - name: yarn2
    port: 8031
    targetPort: 8031
    protocol: TCP
  - name: yarn3
    port: 8032
    targetPort: 8032
    protocol: TCP
  - name: yarn4
    port: 8033
    targetPort: 8033
    protocol: TCP
  - name: yarn5
    port: 8040
    targetPort: 8040
    protocol: TCP
  - name: yarn6
    port: 8042
    targetPort: 8042
    protocol: TCP
  - name: yarnui
    port: 8088
    targetPort: 8088
    protocol: TCP
  - name: hdfs
    port: 9000
    targetPort: 9000
    protocol: TCP
  - name: hdfsui
    port: 50070
    targetPort: 50070
    protocol: TCP
  - name: ssh
    port: 65022
    targetPort: 65022
    protocol: TCP
  clusterIP: None
  publishNotReadyAddresses: true
  selector:
    app: {{ template "{{ .Chart.Name }}.fullname" . }}
    component: wex-hdp
    run: {{ $compHpdLabelRunWorkerStatefulset }}
