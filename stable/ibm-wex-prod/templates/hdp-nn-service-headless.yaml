{{- include "sch.config.init" (list . "ibm-wex-prod.sch.chart.config.values") -}}
{{- $compHdpNnServiceHeadlessName := .sch.chart.components.wex.hdp.nn.service.headlessName }}
{{- $compHpdLabelComponent := .sch.chart.components.wex.hdp.label.component }}
{{- $compHpdLabelRunNnHeadlessService := .sch.chart.components.wex.hdp.label.runNnHeadlessService }}
{{- $compHpdLabelRunNnStatefulset := .sch.chart.components.wex.hdp.label.runNnStatefulset }}

apiVersion: v1
kind: Service
metadata:
  name: {{ include "sch.names.fullCompName" (list . $compHdpNnServiceHeadlessName ) }}
  labels:
    app: {{ template "{{ .Chart.Name }}.fullname" . }}
    chart: {{ .Chart.Name }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
    component: wex-hdp
    run: {{ $compHpdLabelRunNnHeadlessService }}
spec:
  ports:
  - name: hdfs
    port: 9000
    targetPort: 9000
    protocol: TCP
  - name: hdfsui
    port: 50070
    targetPort: 50070
    protocol: TCP
  - name: ssh
    port: 65022
    targetPort: 65022
    protocol: TCP
  clusterIP: None
  publishNotReadyAddresses: true
  selector:
    app: {{ template "{{ .Chart.Name }}.fullname" . }}
    component: wex-hdp
    run: {{ $compHpdLabelRunNnStatefulset }}
