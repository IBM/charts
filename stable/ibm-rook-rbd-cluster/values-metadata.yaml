###############################################################################
# Licensed Materials - Property of IBM
# 5737-E67
# (C) Copyright IBM Corporation 2016, 2018 All Rights Reserved
# US Government Users Restricted Rights - Use, duplication or disclosure
# restricted by GSA ADP Schedule Contract with IBM Corp.
###############################################################################


## Metadata for ibm-rook-rbd-cluster configuration
arch:
  __metadata:
    label: "Architecture Scheduling Preferences"
    description: "Architecture preference for target storage nodes."
  amd64:
    __metadata:
      name: "amd64"
      label: "amd64 scheduling preference"
      description: "Architecture preference for precheck job container."
      type: "string"
      immutable: false
      required: true
      options:
      - label: "0 - Do not use"
        value: "0 - Do not use"
      - label: "1 - Least preferred"
        value: "1 - Least preferred"
      - label: "2 - No preference"
        value: "2 - No preference"
      - label: "3 - Most preferred"
        value: "3 - Most preferred"


rookOperatorNamespace:
  __metadata:
    label: "Rook Ceph Operator Namespace"
    name: "rookOperatorNamespace"
    description: "Namespace in which the Ceph Operator Helm chart is installed.  Ceph Operator Helm chart must be installed before installing this chart."
    type: "string"
    immutable: false
    required: true

cluster:
  __metadata:
    label: "Rook Ceph Cluster Settings"
    description: "Specify settings to create Ceph cluster. The settings contain configuration parameter
                  for pod placement storage selection, mon processes, dashboard, ceph configuration file path, etc."
  dataDirHostPath:
    __metadata:
      name: "dataDirHostPath"
      label: "Configuration Files Path"
      description: "Path on the host where configuration files will be stored. 
                    If not specified, a kubernetes emptyDir will be created (not recommended)."
      type: "string"
      immutable: false
      required: true
  mon:
    count:
      __metadata:
        name: "count"
        label: "Number of Monitoring Processes"
        description: "Sets the number of monitoring processes to be started. The
                       number must be odd and between 1 - 9."
        type: "number"
        immutable: false
        required: true
    allowMultiplePerNode:
      __metadata:
        name: "allowMultiplePerNode"
        label: "Allow Multiple Monitoring Processes per Node "
        description: "Enable this to allow  multiple monitoring proceses on one node."
        type: "boolean"
        immutable: false
        required: true
  network:
    hostNetwork:
      __metadata:
        name: "hostNetwork"
        label: "Enable Host Network"
        description: "Enable to use network of the hosts instead of using the
                      SDN below the containers."
        type: "boolean"
        immutable: false
        required: true
  dashboard:
    enabled:
      __metadata:
        name: "enable"
        label: "Enable Ceph Dashboard"
        description: "Enable to view the Ceph dashboard in your browser."
        type: "boolean"
        immutable: false
        required: true

  placement:
    all:
      enabled:
        __metadata:
          label: "Enable Generic Placement Configuration"
          description: "Enable generic placement configuration for all services 
                        (mon, osd, mgr). The placement configuration is used to 
                        schedule pods on nodes. Each service will have its placement 
                        configuration generated by merging the generic configuration 
                        with the most specific one (which will override any attributes)."
          type: "boolean"
          immutable: false
          required: false
      nodeSelectorTerms:
        __metadata:
          label: "Generic Node Affinity Match Expressions"
          description: "Node affinity match expressions associated with nodeSelectorTerms
                            for all the services (mon, osd, mgr)."
          type: "string"
          immutable: false
          required: false
      tolerations:
        __metadata:
          label: "Tolerations"
          description: "Tolerations that are applied to pods of all the services (mon, osd, mgr)."
          type: "string"
          immutable: false
          required: false
    mon:
      enabled:
        __metadata:
          label: "Enable Placement Configuration For Monitoring Service"
          description: "Enable placement configuration for monitoring service. The placement configuration
                        for this service is generated by merging the generic configuration (if specified)
                        with its specific configuration."
          type: "boolean"
          immutable: false
          required: false
      nodeSelectorTerms:
        __metadata:
          label: "Node Affinity Match Expressions for Monitoring Service"
          description: "Node affinity match expressions associated with nodeSelectorTerms
                            for the monitoring service."
          type: "string"
          immutable: false
          required: false
      tolerations:
        __metadata:
          label: "Tolerations"
          description: "Tolerations that are applied to pods of the  monitoring service."
          type: "string"
          immutable: false
          required: false

    osd:
      enabled:
        __metadata:
          label: "Enable Placement Configuration for ODS service"
          description: "Enable placement configuration for osd service. The placement configuration
                        for this service is generated by merging the generic configuration (if specified)
                        with its specific configuration."
          type: "boolean"
          immutable: false
          required: false
      nodeSelectorTerms:
        __metadata:
          label: "Node Affinity Match Expressions"
          description: "Node affinity match expressions associated with nodeSelectorTerms
                            for the osd service."
          type: "string"
          immutable: false
          required: false
      tolerations:
        __metadata:
          label: "Tolerations"
          description: "Tolerations that are applied to pods of the osd service."
          type: "string"
          immutable: false
          required: false
    mgr:
      enabled:
        __metadata:
          label: "Enable Placement Configuration for Manager Service"
          description: "Enable placement configuration for manager service. The placement configuration
                        for this service is generated by merging the generic configuration (if specified)
                        with its specific configuration."
          type: "boolean"
          immutable: false
          required: false
      nodeSelectorTerms:
        __metadata:
          label: "Node Affinity Match Expressions"
          description: "Node affinity match expressions associated with nodeSelectorTerms
                        for the manager service."
          type: "string"
          immutable: false
          required: false
      tolerations:
        __metadata:
          label: "Tolerations"
          description: "Tolerations that are applied to pods of the manager service."
          type: "string"
          immutable: false
          required: false

  storage:
    useAllNodes:
      __metadata:
        name: "useAllNodes"
        label: "Use All Nodes"
        description: "Enable this to choose all the nodes in the cluster for storage."
        type: "boolean"
        immutable: false
        required: false
    useAllDevices:
      __metadata:
        name: "useAllDevices"
        label: "Use All Devices"
        description: "Enable this to automatically consume all devices found on nodes in the
                      cluster by OSDs. Not recommended unless you have a very controlled
                      environment where you will not risk formatting of devices with existing data."
        type: "boolean"
        immutable: false
        required: false
    deviceFilter:
      __metadata:
        name: "deviceFilter"
        label: "Device Selection Regular Expression"
        description: "A regular expression that allows selection of devices to be consumed
                      by OSDs. For example, sdb: Only selects the sdb device if found, 
                      ^sd[a-d]: Selects devices starting with sda, sdb, sdc, and sdd if found."
        type: "string"
        immutable: false
        required: false
    location:
      __metadata:
        name: "location"
        label: "Location Information"
        description: "Location information about the cluster to help with data placement,
                      such as region or data center."
        type: "string"
        immutable: false
        required: false
    config:
      storeType:
        __metadata:
          name: "storeType"
          label: "Store Type"
          description: "The underlying storage format to use for each OSD. Valid values are 
                        filestore or bluestore"
          type: "string"
          immutable: false
          required: false
          options:
          - label: "filestore"
            value: "filestore"
          - label: "bluestore"
            value: "bluestore"    
      databaseSizeMB:
        __metadata:
          name: "databaseSizeMB"
          label: "Bluestore Database Size in MB"
          description: "The size  of a bluestore database in MB."
          type: "string"
          immutable: false
          required: false
      journalSizeMB:
        __metadata:
          name: "journalSizeMB"
          label: "Filestore Journal Size in MB"
          description: "The size of a filestore journal in MB."
          type: "string"
          immutable: false
          required: false
    nodes:
      __metadata:
        name: "nodes"
        label: "Storage Nodes and Devices"
        description: "Specify list of storage nodes and its devices. Your storage node must be part 
                      of IBM Cloud Private cluster and name must be name as reported by `kubectl get nodes` command.
                      The sample format is provided in input text box below. Refer to Chart README for details."
        type: "string"
        immutable: false
        required: true

  resources:
    __metadata:
      label: "Resources Configuration Settings"
      name: "resources"
      description: "List of resources for mgr, mon, and osd pods. For example,  
                    {\"mgr\": {\"limits\": {\"cpu\":\"500m\", \"memory\": \"1024Mi\"}, 
                    \"requests\": {\"cpu\":\"500m\", \"memory\": \"1024Mi\"}}} for manager
                    pods. Use mon and ods keys for specifying resources for monitoring and
                    osd service respectively."
      type: "string"
      immutable: false
      required: false

pool:
  __metadata:
    label: "Ceph Pool Settings"
    description: "Specify settings to create a storage pool. The settings are
                  failure domain for replica, resiliency types, etc."
  failureDomain:
    __metadata:
      name: "failureDomain"
      label: "Failure Domain" 
      description: "The failure domain across which the replicas or chunks of data will be spread."
      type: "string"
      immutable: false
      required: false 
      options:
        - label: "ods"
          value: "osd"
        - label: "host" 
          value: "host"
  resilienceType:
    __metadata:
      name: "resilienceType"
      label: "Resilience Type" 
      description: "Resilience settings for pool. A pool can be either replicated or erasure-coded for resiliency."
      type: "string"
      immutable: false
      required: false 
      options:
        - label: "Replicated"
          value: "replicated"
        - label: "Erasure Coded"
          value: "erasurecoded"
  replicated:
    size:
      __metadata:
        name: "size"
        label: "Replica Size"
        description: "The number of copies of the data in the pool"
        type: "number"
        immutable: false
        required: true
  erasureCoded:
    dataChunks:
      __metadata:
        name: "dataChunks"
        label: "Number of Data Chunks"
        description: "Original object is devided in to number of chunks."
        type: "number"
        immutable: false
        required: true
    codingChunks:
      __metadata:
        name: "codingChunks"
        label: "Number of Redundant Chunks"
        description: "Number of redundant chunks to store."
        type: "number"
        immutable: false
        required: true

storageClass:
  __metadata:
    label: "StorageClass Configuration"
    description: "Specify settigs to create a storage class."
  create:
    __metadata:
      name: "create"
      label: "Create StorageClass"
      description: "If enabled, creates a storage class along with Rook Ceph cluser installation."
      type: "boolean"
      immutable: false
      required: true
  name:
    __metadata:
      name: "name"
      label: "StorageClass Name"
      description: "The name of storage class that is created while installing Rook Ceph cluser."
      type: "string"
      immutable: false
      required: true
  fsType:
    __metadata:
      name: "fsType"
      label: "File System Type"
      description: "File System to use for the volume created by the storage class."
      type: "string"
      immutable: false
      required: true
      options:
        - label: "ext4"
          value: "ext4"
        - label: "xfs" 
          value: "xfs"
  reclaimPolicy:
    __metadata:
      name: "reclaimPolicy"
      label: "Reclaim Policy"
      description: "Reclaim policy of the persistent volumes dynamically created by the storage class. "
      type: "string"
      immutable: false
      required: true
      options:
        - label: "Delete"
          value: "Delete"
        - label: "Retain"
          value: "Retain"
        - label: "Recycle"
          value: "Recycle"
  volumeBindingMode:
    __metadata:
      name: "volumeBindingMode"
      label: "Volume Binding Mode"
      description: "Indicates how volume should be bound. Defaults to Immediate"
      type: "string"
      immutable: false
      required: true
      options:
        - label: "Immediate"
          value: "Immediate"
        - label: "WaitForFirstConsumer"
          value: "WaitForFirstConsumer"


preValidation:
  __metadata:
    label: "Pre-validation Settings"
    description: "Configure this to enable pre installation checks."
  enabled:
    __metadata:
      name: "enabled"
      label: "Enable Pre-validation Checks"
      description: "Enable it to perform pre-installation validations"
      type: "boolean"
      immutable: false
      required: true

image:
  repository:
    __metadata:
      name: "repository"
      label: "Pre-validation Utility Image Repository"
      description: "Docker registry to pull utility image from."
      type: "string"
      immutable: false
      required: true
  tag:
    __metadata:
      name: "tag"
      label: "Pre-validation Utility Image Tag"
      description: "Image tag is used to choose utility image release version."
      type: "string"
      immutable: false
      required: true
  pullPolicy:
    __metadata:
      name: "pullPolicy"
      label: "Docker Image Pull Policy"
      description: "Docker image pull policy. Allowed values, Always, Never, or IfNotPresent. Defaults to IfNotPresent"
      type: "string"
      immutable: false
      required: true
      options:
      - label: "IfNotPresent"
        value: "IfNotPresent"
      - label: "Always"
        value: "Always"
      - label: "Never"
        value: "Never"
