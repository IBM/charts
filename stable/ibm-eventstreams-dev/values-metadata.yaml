global:
  __metadata:
    label: "Global install settings"
    description: "Values that apply to all components of IBM Event Streams"
  # gid used for secondary group configuration (needed for access permission to remote file systems)
  fsGroupGid:
    __metadata:
      label: "File system group ID"
      description: "The group ID added to the containers with persistent storage to allow access. Volumes that support ownership management must be owned and writable by this group ID"
      type: "string"
      required: false
      validation: "(^[0-9]+$)"
      immutable: false

  arch:
    __metadata:
      label: "Architecture"
      description: "The worker node architecture on which to deploy Event Streams"
      type: "string"
      immutable: false
      required: true
      options:
      - label: "amd64 platforms"
        value: "amd64"
      - label: "s390x platforms"
        value: "s390x"

  ## Image configuration metadata
  image:

    repository:
      __metadata:
        name: "repository"
        label: "Docker image registry"
        description: "Docker registry to pull images from"
        type: "string"
        immutable: false
        required: true

    pullPolicy:
      __metadata:
        label: "Image pull policy"
        description: "Controls when Docker images are fetched from the registry"
        type: "string"
        immutable: false
        required: true
        options:
        - label: "Always"
          value: "Always"
        - label: "Never"
          value: "Never"
        - label: "IfNotPresent"
          value: "IfNotPresent"

    pullSecret:
      __metadata:
        label: "Image pull secret"
        description: "If using a registry that requires authentication, the name of the secret containing credentials"
        type: "string"
        required: false

    imageTags:
      kafkaTag:
        __metadata:
          label: "Kafka image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      metricsReporterTag:
        __metadata:
          label: "Kafka Metrics Reporter image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      healthcheckTag:
        __metadata:
          label: "Kafka Health-Check image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      kafkaProxyTag:
        __metadata:
          label: "Kafka Proxy image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      zookeeperTag:
        __metadata:
          label: "ZooKeeper image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      kafkaMetricsProxyTag:
        __metadata:
          label: "Kafka metrics proxy image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      elasticSearchTag:
        __metadata:
          label: "Elastic search image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      uiTag:
        __metadata:
          label: "User Interface image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      databaseTag:
        __metadata:
          label: "Database image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      restTag:
        __metadata:
          label: "RESTful API image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      oauthTag:
        __metadata:
          label: "Authorization image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      codegenTag:
        __metadata:
          label: "Code Generator image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      restProducerTag:
        __metadata:
          label: "RESTful Producer API image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      restProxyTag:
        __metadata:
          label: "Nginx rest proxy image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      initTag:
        __metadata:
          label: "Init image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      baseTag:
        __metadata:
          label: "Alpine image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      kubectlTag:
        __metadata:
          label: "kubectl image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      roleMappingsTag:
        __metadata:
          label: "Role Mappings image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      telemetryTag:
        __metadata:
          label: "Telemetry image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      accessControllerTag:
        __metadata:
          label: "Access Controller image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      certGenTag:
        __metadata:
          label: "Certificate Generator image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      indexmgrTag:
        __metadata:
          label: "Index Manager image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true
      collectorTag:
        __metadata:
          label: "Collector image tag"
          type: "string"
          description: "A tag is a label applied to a image in a repository. Tags are how various images in a repository are distinguished from each other."
          required: true
          immutable: false
          hidden: true

## Telemetry configuration
telemetry:
  __metadata:
    label: "Insights - help us improve our product"
    description: "Allow IBM to use in-application code to transmit product usage analytics. The data from this in-application code will only be used for product usage on this IBM product, and this usage data will not be shared outside of IBM. The product usage will be used for business reporting and product usage understanding"
  enabled:
    __metadata:
      label: "Share my product usage data"
      description: "Allow product usage analytics to be transmitted to IBM for business reporting and product usage understanding"
      type: "boolean"
      required: false

## global persistence parameters
persistence:
  __metadata:
    label: "Kafka persistent storage settings"
    description: "Configuration values for the persistent volume claims used by Apache Kafka brokers"
  enabled:
    __metadata:
      label: "Enable persistent storage for Apache Kafka"
      description: "Select this checkbox to store Apache Kafka data on a persistent volume so that the data is preserved if the pod is stopped."
      type: "boolean"
      required: true
  useDynamicProvisioning:
    __metadata:
      label: "Use dynamic provisioning for Apache Kafka"
      description: "Select this checkbox to allow the cluster to automatically provision new storage resource and create PersistentVolume objects for Apache Kafka"
      type: "boolean"
      required: true
  dataPVC:
    name:
      __metadata:
        label: "Name"
        description: "Prefix for the name of persistent volume claims used for Apache Kafka"
        type: "string"
        required: true
    storageClassName:
      __metadata:
        label: "Storage class name"
        description: "Storage class of the persistent volume claims created for Apache Kafka"
        type: "string"
        required: false
    size:
      __metadata:
        label: "Size"
        description: "Size of the persistent volume claims created for Apache Kafka"
        type: "string"
        required: true


kafka:
  __metadata:
    label: "Kafka broker settings"
    description: "Configuration values for the Apache Kafka brokers"

  ## Resource requests and limits configuration metadata for Kafka containers
  resources:
    requests:
      cpu:
        __metadata:
          label: "CPU request for Kafka brokers"
          description: "The minimum required CPU core for each Kafka broker. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
          type: "string"
          required: true
      memory:
        __metadata:
          label: "Memory request for Kafka brokers"
          description: "The minimum memory for each Kafka broker in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true
    limits:
      cpu:
        __metadata:
          label: "CPU limit for Kafka brokers"
          description: "The upper limit of CPU core for each Kafka broker. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
          type: "string"
          required: true
      memory:
        __metadata:
          label: "Memory limit for Kafka brokers"
          description: "The memory upper limit for Kafka brokers in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true
  ## Resource requests and limits configuration metadata for metrics-reporter containers
  metricsReporterResources:
    requests:
      memory:
        __metadata:
          label: "Memory request for metrics-reporters"
          description: "The minimum memory for each metrics-reporter sidecar in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true
          hidden: true
    limits:
      memory:
        __metadata:
          label: "Memory limit for metrics-reporters"
          description: "The memory upper limit for each metrics-reporter sidecar in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true
          hidden: true
  ## Replica count configuration metadata
  brokers:
    __metadata:
      name: "brokers"
      label: "Kafka brokers"
      description: "Number of brokers in the Kafka cluster. There must be a minimum of 3 brokers"
      type: "number"
      immutable: false
      required: true
      validation: "(^[3-9]+[0-9]*$)|(^[1-9]+[0-9]+$)"
  configMapName:
    __metadata:
      label: "Cluster configuration ConfigMap"
      description: "The name of an optional ConfigMap used to apply static configuration to all brokers in the cluster. The server.properties files of the brokers are populated using this ConfigMap"
      type: "string"
      required: false
  heapOpts:
    __metadata:
      label: "Kafka JVM Options"
      description: "Provide any extra arguments to pass to the JVM"
      type: "string"
      required: false
      hidden: true
  openJMX:
    __metadata:
      label: "Enable secure JMX connections"
      description: "Select this check box to open each Kafka broker’s JMX port for secure connections from applications running inside the ICP cluster."
      type: "boolean"
      required: true

zookeeper:
  __metadata:
    label: "ZooKeeper settings"
    description: "Configuration values for the Apache ZooKeeper servers"
  resources:
    requests:
      cpu:
        __metadata:
          label: "CPU request for ZooKeeper servers"
          description: "The minimum required CPU core for each ZooKeeeper server. Specify integers, fractions (e.g. 0.5), or millicore values(e.g. 100m, where 100m is equivalent to .1 core)."
          type: "string"
          required: true
      memory:
        __metadata:
          label: "Memory request for ZooKeeper servers"
          description: "The minimum memory for each ZooKeeper server in bytes. Specify integers with one of these suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true
          hidden: true
    limits:
      cpu:
        __metadata:
          label: "CPU limit for ZooKeeper servers"
          description: "The upper limit of CPU core for each ZooKeeper server. Specify integers, fractions (e.g. 0.5), or millicores values(e.g. 100m, where 100m is equivalent to .1 core)."
          type: "string"
          required: true
      memory:
        __metadata:
          label: "Memory limit for ZooKeeper servers"
          description: "The memory limit for ZooKeeper servers in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true
          hidden: true
  persistence:
    enabled:
      __metadata:
        label: "Enable persistent storage for ZooKeeper servers"
        description: "Select this checkbox to store Apache ZooKeeper data on a persistent volume so that the data is preserved if the pod is stopped."
        type: "boolean"
        required: true
    useDynamicProvisioning:
      __metadata:
        label: "Use dynamic provisioning for ZooKeeper servers"
        description: "Select this checkbox to allow the cluster to automatically provision new storage resource and create PersistentVolume objects for Apache ZooKeeper."
        type: "boolean"
        required: true
  dataPVC:
    name:
      __metadata:
        label: "Name"
        description: "Prefix for the name of Persistent Volume Claims used for Apache ZooKeeper"
        type: "string"
        required: true
    storageClassName:
      __metadata:
        label: "Storage class name"
        description: "Storage class of the persistent volume claims created for Apache ZooKeeper"
        type: "string"
        required: false
    size:
      __metadata:
        label: "Size"
        description: "Size of the persistent volume claims created for Apache ZooKeeper"
        type: "string"
        required: true


proxy:
  __metadata:
    label: "External access settings"
    description: "Configuration for network connections to IBM Event Streams"
  externalEndpoint:
    __metadata:
      label: "External hostname/IP address"
      description: "The external hostname or IP address to be used by external clients. Leave blank to default to the IP address of the cluster proxy node."
      type: "string"
      required: false
      validation: "(^\\S*$)"

## TLS info
tls:
  __metadata:
    label: "Secure connection settings"
    description: "Configuration values for TLS connections to IBM Event Streams"
  type:
    __metadata:
      label: "Certificate type"
      description: "Choose whether to supply the necessary certificate details, or have a self-signed certificate generated"
      type: "string"
      required: true
      immutable: false
      options:
      - label: "provided"
        value: "provided"
      - label: "selfsigned"
        value: "selfsigned"
  key:
    __metadata:
      label: "Private key"
      description: "Base64-encoded TLS private key"
      type: "string"
      required: false
  cert:
    __metadata:
      label: "TLS certificate"
      description: "Base64-encoded TLS certificate"
      type: "string"
      required: false
  cacert:
    __metadata:
      label: "CA certificate"
      description: "Base64-encoded CA certificate/bundle"
      type: "string"
      required: false

messageIndexing:
  __metadata:
    label: "Message indexing settings"
    description: "Configuration for message indexing used to enhance browsing the messages on topics"
  messageIndexingEnabled:
    __metadata:
      label: "Enable message indexing"
      description: "Whether to enable indexing of messages"
      type: "boolean"
      required: true
  resources:
    limits:
      memory:
        __metadata:
          label: "Memory limits for Index Manager nodes"
          description: "The memory upper limit in bytes. Specify integers with suffixes: E, P, T, G, M, K, or power-of-two equivalents: Ei, Pi, Ti, Gi, Mi, Ki."
          type: "string"
          required: true

externalMonitoring:
  __metadata:
    label: "External monitoring"
    description: "Enter configuration values for external monitoring tools that require their own configuration settings added to Event Streams resources."
  datadog:
    __metadata:
      label: "Datadog - Autodiscovery annotation check templates for Kafka brokers"
      description: "Enter a YAML object containing the required Autodiscovery check template annotations that are applied to the Kafka brokers. The Datadog prefix and container identifier is applied automatically to the annotation, so only use the template name as the object’s keys (for example, ‘check_names’)."
      type: "string"
      required: false


## License
license:
  __metadata:
    label: "License"
    type: "string"
    description: "Set to accept to indicate that you accept the terms of the license"
    required: true
    options:
    - label: "Accepted"
      value: "accept"
    - label: "Not accepted"
      value: "not_accepted"


## License
checkSupportedPlatform:
  __metadata:
    label: "Check Supported Platform"
    type: "boolean"
    description: "Check whether the chart is being installed on a valid platform. Note, setting this to false may result in Event Streams being installed on an invalid platform"
    required: true
    immutable: true
    hidden: true
